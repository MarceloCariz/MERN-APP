{"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\index.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"25":{"start":{"line":26,"column":4},"end":{"line":26,"column":62}},"26":{"start":{"line":28,"column":0},"end":{"line":28,"column":62}},"27":{"start":{"line":29,"column":0},"end":{"line":29,"column":38}},"28":{"start":{"line":30,"column":18},"end":{"line":30,"column":53}},"29":{"start":{"line":31,"column":15},"end":{"line":31,"column":47}},"30":{"start":{"line":32,"column":15},"end":{"line":32,"column":46}},"31":{"start":{"line":33,"column":15},"end":{"line":33,"column":47}},"32":{"start":{"line":34,"column":24},"end":{"line":34,"column":65}},"33":{"start":{"line":35,"column":22},"end":{"line":35,"column":70}},"34":{"start":{"line":36,"column":22},"end":{"line":36,"column":70}},"35":{"start":{"line":37,"column":22},"end":{"line":37,"column":70}},"36":{"start":{"line":38,"column":25},"end":{"line":38,"column":76}},"37":{"start":{"line":39,"column":26},"end":{"line":39,"column":78}},"38":{"start":{"line":40,"column":17},"end":{"line":40,"column":62}},"39":{"start":{"line":41,"column":18},"end":{"line":41,"column":55}},"40":{"start":{"line":42,"column":23},"end":{"line":42,"column":81}},"41":{"start":{"line":44,"column":12},"end":{"line":44,"column":36}},"42":{"start":{"line":45,"column":0},"end":{"line":45,"column":18}},"43":{"start":{"line":46,"column":0},"end":{"line":46,"column":16}},"44":{"start":{"line":47,"column":0},"end":{"line":47,"column":34}},"45":{"start":{"line":48,"column":0},"end":{"line":48,"column":76}},"46":{"start":{"line":49,"column":0},"end":{"line":49,"column":76}},"47":{"start":{"line":50,"column":0},"end":{"line":50,"column":59}},"48":{"start":{"line":52,"column":0},"end":{"line":52,"column":40}},"49":{"start":{"line":54,"column":0},"end":{"line":54,"column":24}},"50":{"start":{"line":56,"column":0},"end":{"line":56,"column":45}},"51":{"start":{"line":57,"column":0},"end":{"line":57,"column":45}},"52":{"start":{"line":58,"column":0},"end":{"line":58,"column":45}},"53":{"start":{"line":59,"column":0},"end":{"line":59,"column":51}},"54":{"start":{"line":60,"column":0},"end":{"line":60,"column":53}},"55":{"start":{"line":61,"column":0},"end":{"line":61,"column":28}},"56":{"start":{"line":62,"column":13},"end":{"line":62,"column":37}},"57":{"start":{"line":63,"column":15},"end":{"line":65,"column":2}},"58":{"start":{"line":64,"column":4},"end":{"line":64,"column":50}},"59":{"start":{"line":66,"column":0},"end":{"line":66,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":56},"end":{"line":25,"column":57}},"loc":{"start":{"line":25,"column":71},"end":{"line":27,"column":1}},"line":25},"7":{"name":"(anonymous_7)","decl":{"start":{"line":63,"column":32},"end":{"line":63,"column":33}},"loc":{"start":{"line":63,"column":38},"end":{"line":65,"column":1}},"line":63}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":27}},{"start":{"line":25,"column":31},"end":{"line":25,"column":51}},{"start":{"line":25,"column":56},"end":{"line":27,"column":1}}],"line":25},"17":{"loc":{"start":{"line":26,"column":11},"end":{"line":26,"column":61}},"type":"cond-expr","locations":[{"start":{"line":26,"column":37},"end":{"line":26,"column":40}},{"start":{"line":26,"column":43},"end":{"line":26,"column":61}}],"line":26},"18":{"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":33}},"type":"binary-expr","locations":[{"start":{"line":26,"column":12},"end":{"line":26,"column":15}},{"start":{"line":26,"column":19},"end":{"line":26,"column":33}}],"line":26},"19":{"loc":{"start":{"line":62,"column":13},"end":{"line":62,"column":37}},"type":"binary-expr","locations":[{"start":{"line":62,"column":13},"end":{"line":62,"column":29}},{"start":{"line":62,"column":33},"end":{"line":62,"column":37}}],"line":62}},"s":{"0":1,"1":7,"2":7,"3":7,"4":7,"5":7,"6":1,"7":7,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":1,"15":1,"16":0,"17":1,"18":1,"19":1,"20":7,"21":7,"22":1,"23":1,"24":1,"25":11,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":1,"58":1,"59":1},"f":{"0":7,"1":1,"2":0,"3":1,"4":0,"5":1,"6":11,"7":1},"b":{"0":[1,1,1],"1":[1,0],"2":[7,0],"3":[7,0],"4":[7,7],"5":[0,7],"6":[7,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,1],"13":[1,0],"14":[7,0],"15":[7,7],"16":[1,1,1],"17":[7,4],"18":[11,11],"19":[1,0]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/index.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,sDAA8B;AAC9B,gDAAwB;AACxB,+CAAiC;AACjC,gDAAwB;AACxB,kEAAyC;AACzC,uEAA8C;AAC9C,uEAA8C;AAC9C,uEAA8C;AAC9C,6EAAmD;AACnD,+EAAsD;AACtD,+DAA6C;AAC7C,wDAAqC;AAGrC,MAAM,cAAc,GAAG,CAAC,uBAAuB,EAAE,+BAA+B,CAAC,CAAA;AAEjF,iBAAiB;AACjB,MAAM,GAAG,GAAG,IAAA,iBAAO,GAAE,CAAC;AA8BlB,kBAAG;AA7BP,MAAM,CAAC,MAAM,EAAE,CAAC;AAChB,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,IAAI,EAAE,CAAC,CAAC;AACxB,GAAG,CAAC,GAAG,CAAC,IAAA,cAAI,EAAC,EAAE,WAAW,EAAE,IAAI,EAAE,MAAM,EAAE,cAAc,EAAE,CAAC,CAAC,CAAA;AAC5D,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,MAAM,CAAC,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAA,wCAAwC;AAChG,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,UAAU,CAAC,EAAC,QAAQ,EAAE,KAAK,EAAC,CAAC,CAAC,CAAA;AAC9C,QAAQ;AACR,GAAG,CAAC,GAAG,CAAC,IAAA,uBAAY,GAAE,CAAC,CAAC;AAGxB,eAAe;AACf,IAAA,gBAAY,GAAE,CAAC;AAGf,QAAQ;AACR,GAAG,CAAC,GAAG,CAAC,YAAY,EAAE,qBAAU,CAAC,CAAC;AAClC,GAAG,CAAC,GAAG,CAAC,YAAY,EAAE,qBAAU,CAAC,CAAC;AAClC,GAAG,CAAC,GAAG,CAAC,YAAY,EAAE,qBAAU,CAAC,CAAC;AAClC,GAAG,CAAC,GAAG,CAAC,eAAe,EAAE,wBAAa,CAAC,CAAC;AACxC,GAAG,CAAC,GAAG,CAAC,gBAAgB,EAAE,yBAAc,CAAC,CAAC;AAE1C,IAAA,iBAAY,EAAC,GAAG,CAAC,CAAC;AAElB,MAAM,IAAI,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC;AACtC,MAAM,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,EAAE;IACjC,OAAO,CAAC,GAAG,CAAC,0BAA0B,IAAI,EAAE,CAAC,CAAC;AAClD,CAAC,CAAC,CAAA;AAKE,wBAAM","sourcesContent":["import express from 'express';\r\nimport path from 'path';\r\nimport * as dotenv from \"dotenv\";\r\nimport cors from 'cors';\r\nimport cookieParser from 'cookie-parser';\r\nimport authRoutes from './routes/auth.routes';\r\nimport userRoutes from './routes/user.routes';\r\nimport shopRoutes from './routes/shop.routes';\r\nimport productRoutes from './routes/product.routes'\r\nimport categoryRoutes from './routes/category.routes';\r\nimport dbConnection from './database/config';\r\nimport setupSwagger from './swagger';\r\n\r\n\r\nconst allowedOrigins = ['http://localhost:5173', 'https://mymarketm.netlify.app']\r\n\r\n//Configuraciones\r\nconst app = express();\r\ndotenv.config();\r\napp.use(express.json());\r\napp.use(cors({ credentials: true, origin: allowedOrigins }))\r\napp.use(express.static(path.join(__dirname, \"public\")));//directorio publico archivos e imagenes\r\napp.use(express.urlencoded({extended: false}))\r\n//Cookie\r\napp.use(cookieParser());\r\n\r\n\r\n//Base de datos\r\ndbConnection();\r\n\r\n\r\n// Rutas\r\napp.use('/api/auth/', authRoutes);\r\napp.use('/api/user/', userRoutes);\r\napp.use('/api/shop/', shopRoutes);\r\napp.use('/api/product/', productRoutes);\r\napp.use('/api/category/', categoryRoutes);\r\n\r\nsetupSwagger(app);\r\n\r\nconst PORT = process.env.PORT || 4000;\r\nconst server = app.listen(PORT, () => {\r\n    console.log(`Server running on port ${PORT}`);\r\n})\r\n\r\n\r\nexport {\r\n    app,\r\n    server\r\n};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b993f744bad49f1e7105df96b219a82644fa7f87","contentHash":"bc05f73aec1797f41cd62ea38459d42504c180339f7296a0cea36bd4045e07d2"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\auth.routes.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\auth.routes.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":18},"end":{"line":6,"column":53}},"4":{"start":{"line":7,"column":37},"end":{"line":7,"column":89}},"5":{"start":{"line":8,"column":22},"end":{"line":8,"column":55}},"6":{"start":{"line":9,"column":26},"end":{"line":9,"column":67}},"7":{"start":{"line":10,"column":30},"end":{"line":10,"column":92}},"8":{"start":{"line":11,"column":15},"end":{"line":11,"column":41}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":130}},"10":{"start":{"line":13,"column":0},"end":{"line":13,"column":92}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1},"f":{"0":2},"b":{"0":[1,1,1],"1":[1,1],"2":[2,2]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/auth.routes.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/auth.routes.ts"],"names":[],"mappings":";;;;;AAAA,sDAA8B;AAC9B,0FAA6E;AAC7E,wDAAyD;AACzD,oEAAwE;AACxE,6FAAiE;AAGjE,MAAM,MAAM,GAAG,iBAAO,CAAC,MAAM,EAAE,CAAC;AAGhC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAA,6CAAgB,EAAC,6BAAe,CAAC,EAAE,uBAAK,CAAC,CAAC;AAGhE,MAAM,CAAC,GAAG,CAAC,aAAa,EAAE,6BAAe,EAAG,iCAAe,CAAC,CAAC;AAG7D,kBAAe,MAAM,CAAC;AAGtB;;;;;;;;;;;;;;;;;GAiBG;AAEH;;;;;;;;;;;;;;;;;;;;GAoBG","sourcesContent":["import express from 'express';\r\nimport { schemaValidation } from '../middlewares/schemaValidator.middleware';\r\nimport { loginUserSchema } from '../schemas/auth.schema';\r\nimport { login, revalidateToken } from '../controllers/auth.controller';\r\nimport authenticateJWT from '../middlewares/checkJWT.middleware';\r\n\r\n\r\nconst router = express.Router();\r\n\r\n\r\nrouter.post('/login', schemaValidation(loginUserSchema), login);\r\n\r\n\r\nrouter.get('/revalidate', authenticateJWT , revalidateToken);\r\n\r\n\r\nexport default router;\r\n\r\n\r\n/**\r\n * @swagger\r\n *   /auth/login/:\r\n *   post:\r\n *     tags: [Auth]\r\n *     summary: Login for users, admin, shops\r\n *     description: Login for users, admin, shops\r\n *     requestBody:\r\n *          required: true\r\n *          content:\r\n *            application/json:\r\n *              schema:\r\n *               type: object\r\n *               $ref: '#components/schemas/Auth'\r\n *     responses:\r\n *       200:\r\n *         description: return token.\r\n */\r\n\r\n/**\r\n * @swagger\r\n * components:\r\n *  schemas:\r\n *    Auth:\r\n *      type: object\r\n *      properties:\r\n *          email:\r\n *            type: string\r\n *            description: email user\r\n *          password:\r\n *            type: string\r\n *            description: password user\r\n *      required:\r\n *        - email\r\n *        - password\r\n *      example:\r\n *        email: test@correo.com\r\n *        password: \"12345678\"\r\n *             \r\n */"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7513194abd020279ae02fc7a39b2eb11c4506046","contentHash":"69217014d81bd96b45b52d38a57c972f1b599f959a16c4f29194259af7bb1e7a"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\schemaValidator.middleware.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\schemaValidator.middleware.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":34}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":28}},"3":{"start":{"line":5,"column":26},"end":{"line":5,"column":61}},"4":{"start":{"line":6,"column":25},"end":{"line":23,"column":1}},"5":{"start":{"line":6,"column":37},"end":{"line":23,"column":1}},"6":{"start":{"line":7,"column":4},"end":{"line":22,"column":5}},"7":{"start":{"line":8,"column":8},"end":{"line":12,"column":11}},"8":{"start":{"line":13,"column":8},"end":{"line":13,"column":15}},"9":{"start":{"line":16,"column":8},"end":{"line":20,"column":9}},"10":{"start":{"line":17,"column":12},"end":{"line":19,"column":100}},"11":{"start":{"line":19,"column":51},"end":{"line":19,"column":96}},"12":{"start":{"line":21,"column":8},"end":{"line":21,"column":122}},"13":{"start":{"line":24,"column":0},"end":{"line":24,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":25},"end":{"line":6,"column":26}},"loc":{"start":{"line":6,"column":37},"end":{"line":23,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":37},"end":{"line":6,"column":38}},"loc":{"start":{"line":6,"column":57},"end":{"line":23,"column":1}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":19,"column":39},"end":{"line":19,"column":40}},"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":96}},"line":19}},"branchMap":{"0":{"loc":{"start":{"line":16,"column":8},"end":{"line":20,"column":9}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":20,"column":9}},{"start":{"line":16,"column":8},"end":{"line":20,"column":9}}],"line":16}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":8,"6":15,"7":15,"8":14,"9":1,"10":1,"11":1,"12":0,"13":1},"f":{"0":8,"1":15,"2":1},"b":{"0":[1,0]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/schemaValidator.middleware.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/schemaValidator.middleware.ts"],"names":[],"mappings":";;;AACA,6BAA0C;AAC1C,8DAAyD;AAElD,MAAM,gBAAgB,GAC7B,CAAC,MAAoB,EAAE,EAAE,CACzB,CAAC,GAAY,EAAE,GAAY,EAAE,IAAiB,EAAE,EAAE;IAC9C,IAAI;QACA,MAAM,CAAC,KAAK,CAAC;YACT,IAAI,EAAE,GAAG,CAAC,IAAI;YACd,MAAM,EAAE,GAAG,CAAC,MAAM;YAClB,KAAK,EAAE,GAAG,CAAC,KAAK;SACnB,CAAC,CAAC;QACH,IAAI,EAAE,CAAC;KACV;IAAC,OAAO,KAAK,EAAE;QACZ,IAAG,KAAK,YAAY,cAAQ,EAAC;YACzB,OAAO,GAAG;iBACL,MAAM,CAAC,+BAAa,CAAC,UAAU,CAAC;iBAChC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,EAAC,KAAK,EAAE,KAAK,CAAC,IAAI,EAAE,OAAO,EAAE,KAAK,CAAC,OAAO,EAAC,CAAC,CAAC,CAAC,CAAC;SACzF;QACD,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,uBAAuB,EAAC,CAAC,CAAC;KACjG;AACL,CAAC,CAAA;AAlBY,QAAA,gBAAgB,oBAkB5B","sourcesContent":["import { NextFunction, Request, Response } from \"express\";\r\nimport {AnyZodObject, ZodError} from 'zod'\r\nimport { HTTP_RESPONSE } from \"../enums/httpErrors.enum\";\r\n\r\nexport const schemaValidation = \r\n(schema: AnyZodObject) =>\r\n(req: Request, res:Response, next:NextFunction) => {\r\n    try {\r\n        schema.parse({\r\n            body: req.body,\r\n            params: req.params,\r\n            query: req.query\r\n        });\r\n        next();\r\n    } catch (error) {\r\n        if(error instanceof ZodError){\r\n            return res\r\n                .status(HTTP_RESPONSE.BadRequest)\r\n                .json(error.issues.map((issue) => ({field: issue.path, message: issue.message})));\r\n        }\r\n        return res.status(HTTP_RESPONSE.InternalServerError).json({message: \"Internal server Error\"});\r\n    }\r\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d2b9d152811c38bc3564b288c7a0892d809af7bc","contentHash":"d7800d5f4f973bba619eef1e415fe3cdc60038b23e9a6c16d30395172af5f6ef"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\enums\\httpErrors.enum.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\enums\\httpErrors.enum.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":5,"column":0},"end":{"line":15,"column":66}},"3":{"start":{"line":6,"column":4},"end":{"line":6,"column":52}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":62}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":66}},"6":{"start":{"line":9,"column":4},"end":{"line":9,"column":68}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":72}},"8":{"start":{"line":11,"column":4},"end":{"line":11,"column":66}},"9":{"start":{"line":12,"column":4},"end":{"line":12,"column":64}},"10":{"start":{"line":13,"column":4},"end":{"line":13,"column":80}},"11":{"start":{"line":14,"column":4},"end":{"line":14,"column":86}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":1},"end":{"line":5,"column":2}},"loc":{"start":{"line":5,"column":26},"end":{"line":15,"column":1}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":15,"column":3},"end":{"line":15,"column":64}},"type":"binary-expr","locations":[{"start":{"line":15,"column":3},"end":{"line":15,"column":16}},{"start":{"line":15,"column":21},"end":{"line":15,"column":63}}],"line":15}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/enums/httpErrors.enum.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/enums/httpErrors.enum.ts"],"names":[],"mappings":";;;AAAA,IAAY,aAUX;AAVD,WAAY,aAAa;IACrB,+CAAQ,CAAA;IACR,yDAAa,CAAA;IACb,6DAAe,CAAA;IACf,+DAAgB,CAAA;IAChB,mEAAkB,CAAA;IAClB,6DAAe,CAAA;IACf,2DAAc,CAAA;IACd,2EAAsB,CAAA;IACtB,iFAAyB,CAAA;AAC7B,CAAC,EAVW,aAAa,6BAAb,aAAa,QAUxB","sourcesContent":["export enum HTTP_RESPONSE {\r\n    OK = 200,\r\n    Created = 201,\r\n    NoContent = 204,\r\n    BadRequest = 400,\r\n    Unauthorized = 401,\r\n    Forbidden = 403,\r\n    NotFound = 404,\r\n    MethodNotAllowed = 405,\r\n    InternalServerError = 500,\r\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"783e9f619e8875895af21a39448e1b3ee48378b3","contentHash":"777625e6a1f45a3ff5870976d78f170dc140901e0a589e63a65645edbf838e7e"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\auth.schema.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\auth.schema.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":28}},"3":{"start":{"line":5,"column":0},"end":{"line":10,"column":3}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/auth.schema.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/auth.schema.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AAGX,QAAA,eAAe,GAAG,OAAC,CAAC,MAAM,CAAC;IACpC,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC;QACX,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,KAAK,EAAE,CAAC,QAAQ,CAAC,uBAAuB,CAAC;QAC3D,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,EAAC,oDAAoD,CAAC,CAAC,GAAG,CAAC,EAAE,EAAE,kCAAkC,CAAC;KAC/H,CAAC;CACL,CAAC,CAAA","sourcesContent":["import { z } from \"zod\";\r\n\r\n\r\nexport const loginUserSchema = z.object({\r\n    body: z.object({\r\n        email: z.string().email().nonempty(\"El email es requerido\"),\r\n        password: z.string().min(8,\"La contraseña debe tener un minimo de 8 caracteres\").max(20, \"La contraseña es demasiado larga\")\r\n    })\r\n})"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"51acb14dc358df8df83f665589c05a31fdc7916b","contentHash":"6a32257b0214a247a735ec539f9de73514a5396cde5389b4cd86b337514a89f4"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\auth.controller.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\auth.controller.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":49}},"4":{"start":{"line":7,"column":19},"end":{"line":7,"column":55}},"5":{"start":{"line":8,"column":15},"end":{"line":8,"column":57}},"6":{"start":{"line":9,"column":14},"end":{"line":9,"column":39}},"7":{"start":{"line":10,"column":15},"end":{"line":10,"column":57}},"8":{"start":{"line":11,"column":26},"end":{"line":11,"column":61}},"9":{"start":{"line":12,"column":14},"end":{"line":41,"column":1}},"10":{"start":{"line":13,"column":32},"end":{"line":13,"column":40}},"11":{"start":{"line":14,"column":4},"end":{"line":40,"column":5}},"12":{"start":{"line":15,"column":19},"end":{"line":15,"column":23}},"13":{"start":{"line":16,"column":21},"end":{"line":16,"column":60}},"14":{"start":{"line":17,"column":21},"end":{"line":17,"column":60}},"15":{"start":{"line":18,"column":8},"end":{"line":20,"column":9}},"16":{"start":{"line":19,"column":12},"end":{"line":19,"column":26}},"17":{"start":{"line":21,"column":8},"end":{"line":23,"column":9}},"18":{"start":{"line":22,"column":12},"end":{"line":22,"column":26}},"19":{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},"20":{"start":{"line":25,"column":12},"end":{"line":25,"column":127}},"21":{"start":{"line":29,"column":30},"end":{"line":29,"column":85}},"22":{"start":{"line":30,"column":8},"end":{"line":31,"column":127}},"23":{"start":{"line":31,"column":12},"end":{"line":31,"column":127}},"24":{"start":{"line":33,"column":22},"end":{"line":33,"column":112}},"25":{"start":{"line":34,"column":8},"end":{"line":36,"column":11}},"26":{"start":{"line":39,"column":8},"end":{"line":39,"column":115}},"27":{"start":{"line":42,"column":0},"end":{"line":42,"column":22}},"28":{"start":{"line":43,"column":24},"end":{"line":70,"column":1}},"29":{"start":{"line":44,"column":16},"end":{"line":44,"column":23}},"30":{"start":{"line":45,"column":21},"end":{"line":45,"column":33}},"31":{"start":{"line":46,"column":18},"end":{"line":46,"column":27}},"32":{"start":{"line":47,"column":4},"end":{"line":69,"column":5}},"33":{"start":{"line":48,"column":23},"end":{"line":48,"column":57}},"34":{"start":{"line":49,"column":23},"end":{"line":49,"column":57}},"35":{"start":{"line":51,"column":8},"end":{"line":53,"column":9}},"36":{"start":{"line":52,"column":12},"end":{"line":52,"column":26}},"37":{"start":{"line":54,"column":8},"end":{"line":56,"column":9}},"38":{"start":{"line":55,"column":12},"end":{"line":55,"column":26}},"39":{"start":{"line":57,"column":8},"end":{"line":58,"column":149}},"40":{"start":{"line":58,"column":12},"end":{"line":58,"column":149}},"41":{"start":{"line":59,"column":22},"end":{"line":59,"column":76}},"42":{"start":{"line":60,"column":8},"end":{"line":65,"column":11}},"43":{"start":{"line":68,"column":8},"end":{"line":68,"column":138}},"44":{"start":{"line":71,"column":0},"end":{"line":71,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":12,"column":14},"end":{"line":12,"column":15}},"loc":{"start":{"line":12,"column":34},"end":{"line":41,"column":1}},"line":12},"2":{"name":"(anonymous_2)","decl":{"start":{"line":43,"column":24},"end":{"line":43,"column":25}},"loc":{"start":{"line":43,"column":44},"end":{"line":70,"column":1}},"line":43}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":18,"column":8},"end":{"line":20,"column":9}},"type":"if","locations":[{"start":{"line":18,"column":8},"end":{"line":20,"column":9}},{"start":{"line":18,"column":8},"end":{"line":20,"column":9}}],"line":18},"4":{"loc":{"start":{"line":21,"column":8},"end":{"line":23,"column":9}},"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":23,"column":9}},{"start":{"line":21,"column":8},"end":{"line":23,"column":9}}],"line":21},"5":{"loc":{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},"type":"if","locations":[{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},{"start":{"line":24,"column":8},"end":{"line":26,"column":9}}],"line":24},"6":{"loc":{"start":{"line":30,"column":8},"end":{"line":31,"column":127}},"type":"if","locations":[{"start":{"line":30,"column":8},"end":{"line":31,"column":127}},{"start":{"line":30,"column":8},"end":{"line":31,"column":127}}],"line":30},"7":{"loc":{"start":{"line":51,"column":8},"end":{"line":53,"column":9}},"type":"if","locations":[{"start":{"line":51,"column":8},"end":{"line":53,"column":9}},{"start":{"line":51,"column":8},"end":{"line":53,"column":9}}],"line":51},"8":{"loc":{"start":{"line":54,"column":8},"end":{"line":56,"column":9}},"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":56,"column":9}},{"start":{"line":54,"column":8},"end":{"line":56,"column":9}}],"line":54},"9":{"loc":{"start":{"line":57,"column":8},"end":{"line":58,"column":149}},"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":58,"column":149}},{"start":{"line":57,"column":8},"end":{"line":58,"column":149}}],"line":57}},"s":{"0":1,"1":3,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":5,"11":5,"12":5,"13":5,"14":5,"15":5,"16":2,"17":5,"18":3,"19":5,"20":0,"21":5,"22":5,"23":1,"24":4,"25":4,"26":0,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":0,"37":1,"38":1,"39":1,"40":0,"41":1,"42":1,"43":0,"44":1},"f":{"0":3,"1":5,"2":1},"b":{"0":[1,1,1],"1":[2,1],"2":[3,3],"3":[2,3],"4":[3,2],"5":[0,5],"6":[1,4],"7":[0,1],"8":[1,0],"9":[0,1]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/auth.controller.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/auth.controller.ts"],"names":[],"mappings":";;;;;;AACA,wDAA8B;AAC9B,0DAAkC;AAClC,wCAA6C;AAE7C,0DAAkC;AAClC,8DAAyD;AAGlD,MAAM,KAAK,GAAG,KAAK,EAAC,GAAY,EAAE,GAAa,EAAE,EAAE;IACtD,MAAM,EAAC,KAAK,EAAE,QAAQ,EAAC,GAAG,GAAG,CAAC,IAAI,CAAC;IACnC,IAAI;QACA,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAI,MAAM,GAAG,MAAM,cAAI,CAAC,OAAO,CAAC,EAAC,KAAK,EAAC,CAAC,CAAC,CAAC,6BAA6B;QACvE,IAAI,MAAM,GAAG,MAAM,cAAI,CAAC,OAAO,CAAC,EAAC,KAAK,EAAC,CAAC,CAAC;QAGzC,IAAG,MAAM,EAAC;YACN,IAAI,GAAG,MAAM,CAAC;SACjB;QACD,IAAG,MAAM,EAAC;YACN,IAAI,GAAG,MAAM,CAAC;SACjB;QAED,IAAG,CAAC,IAAI,EAAC;YACL,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAC,+BAA+B,EAAC,CAAC,CAAA;SAChG;QAAA,CAAC;QAIF,mBAAmB;QACnB,MAAM,aAAa,GAAG,kBAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAElE,IAAG,CAAC,aAAa;YAAE,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAC,+BAA+B,EAAC,CAAC,CAAC;QAEjH,aAAa;QACb,MAAM,KAAK,GAAG,MAAM,IAAA,iBAAW,EAAC,EAAC,GAAG,EAAE,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAC,CAAC,CAAC;QAE5F,GAAG,CAAC,IAAI,CAAC;YACL,KAAK;SACR,CAAC,CAAA;KAGL;IAAC,OAAO,KAAK,EAAE;QACZ,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAC,uBAAuB,EAAC,CAAC,CAAA;KACxF;AACL,CAAC,CAAA;AArCY,QAAA,KAAK,SAqCjB;AAGM,MAAM,eAAe,GAAG,KAAK,EAAC,GAAgB,EAAE,GAAa,EAAE,EAAE;IAEpE,MAAM,GAAG,GAAG,GAAG,CAAC,GAAI,CAAC;IACrB,MAAM,QAAQ,GAAG,GAAG,CAAC,QAAS,CAAC;IAC/B,MAAM,KAAK,GAAG,GAAG,CAAC,KAAM,CAAC;IAEzB,IAAI;QAEA,MAAM,MAAM,GAAG,MAAM,cAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;QACxC,MAAM,MAAM,GAAG,MAAM,cAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;QAExC,IAAI,IAAI,CAAC;QAET,IAAG,MAAM,EAAC;YACN,IAAI,GAAG,MAAM,CAAC;SACjB;QAED,IAAG,MAAM,EAAC;YACN,IAAI,GAAG,MAAM,CAAC;SACjB;QAED,IAAG,CAAC,IAAI;YAAE,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,uDAAuD,EAAC,CAAC,CAAA;QAE9H,MAAM,KAAK,GAAG,MAAM,IAAA,iBAAW,EAAC,EAAC,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAC,CAAC,CAAC;QAExD,GAAG,CAAC,IAAI,CAAC;YACL,GAAG;YACH,QAAQ;YACR,KAAK;YACL,KAAK;SACR,CAAC,CAAA;KACL;IAAC,OAAO,KAAK,EAAE;QACZ,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,uDAAuD,EAAC,CAAC,CAAA;KAChH;AAEL,CAAC,CAAA;AAnCY,QAAA,eAAe,mBAmC3B","sourcesContent":["import { Request, Response } from \"express\";\r\nimport bcrypt from 'bcryptjs';\r\nimport User from \"../models/User\";\r\nimport { generateJWT } from \"../helpers/jwt\";\r\nimport { JWTRequestI } from \"../middlewares/checkJWT.middleware\";\r\nimport Shop from \"../models/Shop\";\r\nimport { HTTP_RESPONSE } from \"../enums/httpErrors.enum\";\r\n\r\n\r\nexport const login = async(req: Request, res: Response) => {\r\n    const {email, password} = req.body;\r\n    try {\r\n        let user = null;\r\n        let isUser = await User.findOne({email}); // Busca al usuario por email\r\n        let isShop = await Shop.findOne({email});\r\n\r\n        \r\n        if(isShop){\r\n            user = isShop;\r\n        }\r\n        if(isUser){\r\n            user = isUser;\r\n        }\r\n\r\n        if(!user){ \r\n            return res.status(HTTP_RESPONSE.Unauthorized).json({message:\"Email o contraseña incorrecto\"})\r\n        };\r\n\r\n\r\n\r\n        //Validar passoword\r\n        const validPassword = bcrypt.compareSync(password, user.password);\r\n\r\n        if(!validPassword) return res.status(HTTP_RESPONSE.Unauthorized).json({message:\"Email o contraseña incorrecto\"});\r\n\r\n        //Generar jwt\r\n        const token = await generateJWT({uid: user.id, username: user.username, roles: user.roles});\r\n\r\n        res.json({\r\n            token\r\n        })\r\n\r\n        \r\n    } catch (error) {\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message:\"Internal server error\"})\r\n    }\r\n}\r\n\r\n\r\nexport const revalidateToken = async(req: JWTRequestI, res: Response) => {\r\n\r\n    const uid = req.uid!;\r\n    const username = req.username!;\r\n    const roles = req.roles!;\r\n\r\n    try {\r\n\r\n        const isUser = await User.findById(uid);\r\n        const isShop = await Shop.findById(uid);\r\n    \r\n        let user;\r\n    \r\n        if(isUser){\r\n            user = isUser;\r\n        }\r\n    \r\n        if(isShop){\r\n            user = isShop;\r\n        }\r\n\r\n        if(!user) return res.status(HTTP_RESPONSE.BadRequest).json({message: \"Usuario no encontrado, no se puede revalidar el token\"})\r\n\r\n        const token = await generateJWT({uid, username, roles});\r\n\r\n        res.json({\r\n            uid,\r\n            username,\r\n            roles,\r\n            token\r\n        })\r\n    } catch (error) {\r\n        res.status(HTTP_RESPONSE.BadRequest).json({message: \"Usuario no encontrado, no se puede revalidar el token\"})\r\n    }\r\n\r\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"0a1a7091a0692029417e237958ab2d13c4795659","contentHash":"e4d3101288d7393ebca02363582e6e8dfb191cf24c7018f958cbd839c72b6b37"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\User.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\User.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":19},"end":{"line":25,"column":2}},"3":{"start":{"line":26,"column":0},"end":{"line":26,"column":60}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/User.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/User.ts"],"names":[],"mappings":";;AAAA,uCAAmE;AAYnE,MAAM,UAAU,GAAG,IAAI,iBAAM,CAAQ;IACjC,QAAQ,EAAC;QACL,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,KAAK,EAAE;QACH,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE,IAAI;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,QAAQ,EAAE;QACN,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,OAAO,EAAE;QACL,IAAI,EAAE,iBAAM,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI;KAC9D;IACD,KAAK,EAAC;QACF,IAAI,EAAE,CAAC,MAAM,CAAC;QACd,QAAQ,EAAE,IAAI;KACjB;CACJ,CAAC,CAAC;AAGH,kBAAe,IAAA,gBAAK,EAAC,MAAM,EAAE,UAAU,CAAC,CAAC","sourcesContent":["import { Schema, SchemaDefinitionProperty, model } from \"mongoose\";\r\nimport {RolesEnum} from '../enums/user.enum';\r\n\r\nexport interface UserI{\r\n    username: string,\r\n    email: string,\r\n    password:string,\r\n    profile: SchemaDefinitionProperty<string>,\r\n    roles: RolesEnum[],\r\n}\r\n\r\n\r\nconst UserSchema = new Schema<UserI>({\r\n    username:{\r\n        type: String,\r\n        required: true,\r\n    },\r\n    email: {\r\n        type: String,\r\n        unique: true,\r\n        required: true,\r\n    },\r\n    password: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    profile: {\r\n        type: Schema.Types.ObjectId, ref: \"Profile\", required: true\r\n    },\r\n    roles:{\r\n        type: [String],\r\n        required: true\r\n    }\r\n});\r\n\r\n\r\nexport default model('User', UserSchema);"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"234b28e481020f95984bb16f09298ed1d7ae680b","contentHash":"0693e521a1edbb5278e9f6dfc6502258626574b9966312b2e98e3bc04d8d972c"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\helpers\\jwt.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\helpers\\jwt.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":29}},"4":{"start":{"line":7,"column":23},"end":{"line":7,"column":63}},"5":{"start":{"line":8,"column":20},"end":{"line":23,"column":1}},"6":{"start":{"line":9,"column":4},"end":{"line":22,"column":7}},"7":{"start":{"line":10,"column":24},"end":{"line":10,"column":48}},"8":{"start":{"line":11,"column":8},"end":{"line":21,"column":11}},"9":{"start":{"line":15,"column":12},"end":{"line":18,"column":13}},"10":{"start":{"line":16,"column":16},"end":{"line":16,"column":33}},"11":{"start":{"line":17,"column":16},"end":{"line":17,"column":54}},"12":{"start":{"line":20,"column":12},"end":{"line":20,"column":27}},"13":{"start":{"line":24,"column":0},"end":{"line":24,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":20},"end":{"line":8,"column":21}},"loc":{"start":{"line":8,"column":50},"end":{"line":23,"column":1}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":23},"end":{"line":9,"column":24}},"loc":{"start":{"line":9,"column":44},"end":{"line":22,"column":5}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":11},"end":{"line":13,"column":12}},"loc":{"start":{"line":13,"column":27},"end":{"line":21,"column":9}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":11,"column":45},"end":{"line":11,"column":78}},"type":"binary-expr","locations":[{"start":{"line":11,"column":45},"end":{"line":11,"column":72}},{"start":{"line":11,"column":76},"end":{"line":11,"column":78}}],"line":11},"4":{"loc":{"start":{"line":15,"column":12},"end":{"line":18,"column":13}},"type":"if","locations":[{"start":{"line":15,"column":12},"end":{"line":18,"column":13}},{"start":{"line":15,"column":12},"end":{"line":18,"column":13}}],"line":15}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":5,"7":5,"8":5,"9":5,"10":0,"11":0,"12":5,"13":1},"f":{"0":1,"1":5,"2":5,"3":5},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[5,0],"4":[0,5]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/helpers/jwt.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/helpers/jwt.ts"],"names":[],"mappings":";;;;;;AAAA,gEAA+B;AASxB,MAAM,WAAW,GAAO,CAAC,EAAC,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAM,EAAE,EAAE;IAC3D,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;QAEnC,MAAM,OAAO,GAAG,EAAC,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAC,CAAC,CAAC,sBAAsB;QAE9D,sBAAG,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,eAAe,IAAI,EAAE,EAAE;YACjD,SAAS,EAAE,IAAI;SAClB,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,EAAE;YACd,eAAe;YACf,IAAG,GAAG,EAAC;gBACH,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;gBAChB,MAAM,CAAC,6BAA6B,CAAC,CAAA;aACxC;YAED,yBAAyB;YACzB,OAAO,CAAC,KAAK,CAAC,CAAC;QAEnB,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAA;AACN,CAAC,CAAA;AAnBY,QAAA,WAAW,eAmBvB","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport { RolesEnum } from \"../enums/user.enum\";\r\n\r\ninterface JwtI{\r\n    uid: string,\r\n    username: string,\r\n    roles: RolesEnum[]\r\n}\r\n\r\nexport const generateJWT:any = ({uid, username, roles}:JwtI) => {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        const payload = {uid, username, roles}; // Contenido del token\r\n\r\n        jwt.sign(payload, process.env.SECRET_JWT_SEED || \"\", {\r\n            expiresIn: '4h',\r\n        }, (err, token) => { // callback\r\n            // Si hay error\r\n            if(err){\r\n                console.log(err)\r\n                reject(\"No se pudo generar el token\")\r\n            }\r\n\r\n            //Envio el token generado\r\n            resolve(token);\r\n\r\n        });\r\n    })\r\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a3d77eae2d0f81b6f3b46240af7065b8245d18d5","contentHash":"18f06a3e71cf5505e7ce814a7902de48237cb5581ba5f1e7181f4b44ae9f126b"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\Shop.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\Shop.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":49}},"3":{"start":{"line":5,"column":19},"end":{"line":33,"column":2}},"4":{"start":{"line":34,"column":0},"end":{"line":34,"column":60}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/Shop.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/Shop.ts"],"names":[],"mappings":";;AAAA,uCAAyC;AACzC,kDAA+C;AAY/C,MAAM,UAAU,GAAG,IAAI,iBAAM,CAAQ;IACjC,QAAQ,EAAE;QACN,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,QAAQ,EAAC;QACL,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,QAAQ,EAAC;QACL,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,KAAK,EAAE;QACH,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;QACd,MAAM,EAAE,IAAI;KACf;IACD,QAAQ,EAAE;QACN;YACI,IAAI,EAAE,iBAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,GAAG,EAAE,SAAS,EAAE,mCAAmC;SACtD;KACJ;IACD,KAAK,EAAE;QACH,IAAI,EAAE,CAAC,MAAM,CAAC;QACd,OAAO,EAAE,CAAC,qBAAS,CAAC,IAAI,CAAC;KAC5B;CACJ,CAAC,CAAC;AAEH,kBAAe,IAAA,gBAAK,EAAQ,MAAM,EAAE,UAAU,CAAC,CAAC","sourcesContent":["import { Schema, model } from \"mongoose\";\r\nimport { RolesEnum } from \"../enums/user.enum\";\r\n\r\nexport interface ShopI {\r\n    _id?: string;\r\n    username: string;\r\n    shopName: string;\r\n    email: string;\r\n    password: string;\r\n    products: string[]; // Referencia a los IDs de los productos\r\n    roles: RolesEnum[];\r\n}\r\n\r\nconst ShopSchema = new Schema<ShopI>({\r\n    username: {\r\n        type: String,\r\n        required: true,\r\n    },\r\n    shopName:{\r\n        type: String,\r\n        required: true\r\n    },\r\n    password:{\r\n        type: String,\r\n        required: true\r\n    },\r\n    email: {\r\n        type: String,\r\n        required: true,\r\n        unique: true,\r\n    },\r\n    products: [\r\n        {\r\n            type: Schema.Types.ObjectId,\r\n            ref: \"Product\", // Referencia al modelo de Producto\r\n        },\r\n    ],\r\n    roles: {\r\n        type: [String],\r\n        default: [RolesEnum.SHOP]\r\n    }\r\n});\r\n\r\nexport default model<ShopI>(\"Shop\", ShopSchema);\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"13d56d6bd7b58b61794a52b7a4652b981a82a24c","contentHash":"fa0ede75361377f5152cd1d0d6571ccae3fdbb3494fda14c6a6e6349c41f2c9b"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\enums\\user.enum.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\enums\\user.enum.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"2":{"start":{"line":5,"column":0},"end":{"line":9,"column":54}},"3":{"start":{"line":6,"column":4},"end":{"line":6,"column":33}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":31}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":1},"end":{"line":5,"column":2}},"loc":{"start":{"line":5,"column":22},"end":{"line":9,"column":1}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":3},"end":{"line":9,"column":52}},"type":"binary-expr","locations":[{"start":{"line":9,"column":3},"end":{"line":9,"column":12}},{"start":{"line":9,"column":17},"end":{"line":9,"column":51}}],"line":9}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/enums/user.enum.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/enums/user.enum.ts"],"names":[],"mappings":";;;AAAA,IAAY,SAIX;AAJD,WAAY,SAAS;IACjB,4BAAe,CAAA;IACf,0BAAa,CAAA;IACb,0BAAa,CAAA;AACjB,CAAC,EAJW,SAAS,yBAAT,SAAS,QAIpB;AAAA,CAAC","sourcesContent":["export enum RolesEnum {\r\n    ADMIN = \"admin\",\r\n    USER = \"user\",\r\n    SHOP = \"shop\"\r\n};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"10fd9215752d5fd533a2b1bb7b501db8740de729","contentHash":"e0dc717a95950496df799a8ed1f6b50fa007af0694214d08cc993b317a6faa89"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\checkJWT.middleware.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\checkJWT.middleware.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":23},"end":{"line":6,"column":63}},"4":{"start":{"line":7,"column":26},"end":{"line":7,"column":61}},"5":{"start":{"line":9,"column":24},"end":{"line":25,"column":1}},"6":{"start":{"line":10,"column":18},"end":{"line":10,"column":60}},"7":{"start":{"line":11,"column":4},"end":{"line":13,"column":5}},"8":{"start":{"line":12,"column":8},"end":{"line":12,"column":136}},"9":{"start":{"line":14,"column":4},"end":{"line":24,"column":5}},"10":{"start":{"line":15,"column":41},"end":{"line":15,"column":106}},"11":{"start":{"line":17,"column":8},"end":{"line":17,"column":22}},"12":{"start":{"line":18,"column":8},"end":{"line":18,"column":32}},"13":{"start":{"line":19,"column":8},"end":{"line":19,"column":26}},"14":{"start":{"line":20,"column":8},"end":{"line":20,"column":15}},"15":{"start":{"line":23,"column":8},"end":{"line":23,"column":123}},"16":{"start":{"line":26,"column":0},"end":{"line":26,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":24},"end":{"line":9,"column":25}},"loc":{"start":{"line":9,"column":44},"end":{"line":25,"column":1}},"line":9}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":11,"column":4},"end":{"line":13,"column":5}},"type":"if","locations":[{"start":{"line":11,"column":4},"end":{"line":13,"column":5}},{"start":{"line":11,"column":4},"end":{"line":13,"column":5}}],"line":11}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":23,"7":23,"8":1,"9":22,"10":22,"11":21,"12":21,"13":21,"14":21,"15":1,"16":1},"f":{"0":1,"1":23},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[1,22]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/checkJWT.middleware.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/checkJWT.middleware.ts"],"names":[],"mappings":";;;;;AACA,gEAA+B;AAE/B,8DAAyD;AAYzD,wBAAwB;AACxB,MAAM,eAAe,GAAG,CAAC,GAAe,EAAE,GAAY,EAAE,IAAkB,EAAE,EAAE;IAE1E,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,eAAe,CAAC,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,mCAAmC;IAE7F,IAAG,CAAC,KAAK,EAAC;QACN,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,4CAA4C,EAAC,CAAC,CAAA;KAC9G;IAED,IAAI;QACA,MAAM,EAAC,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAC,GAAO,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,eAAgB,CAAC,CAAC;QAGnF,+BAA+B;QAC/B,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;QACd,GAAG,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACxB,GAAG,CAAC,KAAK,GAAG,KAAK,CAAC;QAElB,IAAI,EAAE,CAAC,CAAC,iCAAiC;KAE5C;IAAC,OAAO,KAAK,EAAE;QACZ,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,kCAAkC,EAAC,CAAC,CAAC;KAClG;AACL,CAAC,CAAA;AAED,kBAAe,eAAe,CAAC","sourcesContent":["import {Request, Response, NextFunction} from 'express';\r\nimport jwt from 'jsonwebtoken';\r\nimport { RolesEnum } from '../enums/user.enum';\r\nimport { HTTP_RESPONSE } from '../enums/httpErrors.enum';\r\n\r\n\r\nexport interface JWTRequestI extends Request{\r\n    uid?: string,\r\n    username?: string,\r\n    roles?: RolesEnum[]\r\n}\r\n\r\n\r\n\r\n\r\n// Autenticacion con jwt\r\nconst authenticateJWT = (req:JWTRequestI, res:Response, next: NextFunction) => {\r\n\r\n    const token = req.header('Authorization')?.split(' ')[1]; // ['Bearer', 'token']  [1] = token\r\n\r\n    if(!token){\r\n        return res.status(HTTP_RESPONSE.Unauthorized).json({message: 'No se proporciono un token de autorizacion'})\r\n    }\r\n\r\n    try {\r\n        const {uid, username, roles}:any = jwt.verify(token, process.env.SECRET_JWT_SEED!);\r\n\r\n\r\n        // Guardar la info del usuario \r\n        req.uid = uid;\r\n        req.username = username;\r\n        req.roles = roles;\r\n\r\n        next(); // pasa al siguiente, controlador\r\n\r\n    } catch (error) {\r\n        return res.status(HTTP_RESPONSE.Forbidden).json({message: 'Token de autenticacion no valido'});\r\n    }\r\n}\r\n\r\nexport default authenticateJWT;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b64bb52c79e0d535edc8d498691bd7aaf74f3b25","contentHash":"3bc9adb8913db69b02481651c731a773bc12b540ac6a7910b844c006ad8ab6b0"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\user.routes.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\user.routes.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":18},"end":{"line":6,"column":53}},"4":{"start":{"line":7,"column":26},"end":{"line":7,"column":67}},"5":{"start":{"line":8,"column":37},"end":{"line":8,"column":89}},"6":{"start":{"line":9,"column":22},"end":{"line":9,"column":55}},"7":{"start":{"line":10,"column":30},"end":{"line":10,"column":92}},"8":{"start":{"line":11,"column":37},"end":{"line":11,"column":106}},"9":{"start":{"line":12,"column":20},"end":{"line":12,"column":49}},"10":{"start":{"line":13,"column":17},"end":{"line":13,"column":51}},"11":{"start":{"line":14,"column":29},"end":{"line":14,"column":73}},"12":{"start":{"line":15,"column":16},"end":{"line":15,"column":48}},"13":{"start":{"line":16,"column":15},"end":{"line":16,"column":49}},"14":{"start":{"line":17,"column":15},"end":{"line":17,"column":41}},"15":{"start":{"line":18,"column":0},"end":{"line":18,"column":137}},"16":{"start":{"line":19,"column":0},"end":{"line":19,"column":164}},"17":{"start":{"line":20,"column":0},"end":{"line":20,"column":288}},"18":{"start":{"line":21,"column":0},"end":{"line":21,"column":140}},"19":{"start":{"line":22,"column":0},"end":{"line":22,"column":158}},"20":{"start":{"line":23,"column":0},"end":{"line":23,"column":44}},"21":{"start":{"line":24,"column":0},"end":{"line":38,"column":3}},"22":{"start":{"line":25,"column":17},"end":{"line":25,"column":30}},"23":{"start":{"line":26,"column":16},"end":{"line":26,"column":28}},"24":{"start":{"line":27,"column":4},"end":{"line":36,"column":7}},"25":{"start":{"line":37,"column":4},"end":{"line":37,"column":23}},"26":{"start":{"line":39,"column":0},"end":{"line":39,"column":84}},"27":{"start":{"line":40,"column":0},"end":{"line":40,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":24,"column":24},"end":{"line":24,"column":25}},"loc":{"start":{"line":24,"column":38},"end":{"line":38,"column":1}},"line":24}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":4,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":0,"23":0,"24":0,"25":0,"26":1,"27":1},"f":{"0":4,"1":0},"b":{"0":[1,1,1],"1":[2,2],"2":[4,4]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/user.routes.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/user.routes.ts"],"names":[],"mappings":";;;;;AAAA,sDAA8B;AAC9B,oEAAyH;AACzH,0FAA6E;AAC7E,wDAAqG;AACrG,6FAAiE;AACjE,2GAAsE;AACtE,kDAA+C;AAE/C,oDAA4B;AAC5B,0EAA4D;AAG5D,MAAM,OAAO,GAAG,gBAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;AACvC,MAAM,MAAM,GAAG,IAAA,gBAAM,EAAC,EAAC,OAAO,EAAC,CAAC,CAAA;AAGhC,MAAM,MAAM,GAAG,iBAAO,CAAC,MAAM,EAAE,CAAC;AAEhC,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,IAAA,6CAAgB,EAAC,8BAAgB,CAAC,EAAG,4BAAU,CAAC,CAAC;AAGxE,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,KAAK,CAAC,CAAC,EAAE,4BAAU,CAAC,CAAC;AAE5F,MAAM,CAAC,GAAG,CAAC,kBAAkB,EACzB,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,IAAI,CAAC,EAAE,IAAA,6CAAgB,EAAC,qCAAuB,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,EACpH,+BAAa,CAAC,CAAC;AAEvB,MAAM,CAAC,GAAG,CAAC,aAAa,EAAE,IAAA,6CAAgB,EAAC,8BAAgB,CAAC,EAAE,4BAAU,CAAE,CAAC;AAE3E,MAAM,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,IAAI,CAAC,CAAC,EAAE,4BAAU,CAAC,CAAC;AAEtF,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,0BAAQ,CAAC,CAAC;AAG1B,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;IACjC,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC;IAC3B,MAAO,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC;IAC1B,GAAG,CAAC,MAAM,CAAC,QAAQ,GAAG,EAAE,EAAE,IAAI,EAAC;QAC3B,6BAA6B;QAC7B,mBAAmB;QACnB,aAAa;QACb,MAAM,EAAE,QAAQ;QAChB,QAAQ,EAAE,MAAM;QAChB,MAAM,EAAE,IAAI;QACZ,qCAAqC;QACrC,aAAa;KAChB,CAAC,CAAA;IACF,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;AACtB,CAAC,CAAC,CAAA;AAGF,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,6BAAe,EAAC,4BAAO,CAAC,CAAA;AAG/C,kBAAe,MAAM,CAAC","sourcesContent":["import express from 'express';\r\nimport { createUser, deleteUser, getProfile, getUsers, updateProfile, updateUser } from '../controllers/user.controller';\r\nimport { schemaValidation } from '../middlewares/schemaValidator.middleware';\r\nimport { createUserSchema, updateProfileUserSchema, updateUserSchema } from '../schemas/user.schema';\r\nimport authenticateJWT from '../middlewares/checkJWT.middleware';\r\nimport authorizeRole from '../middlewares/authorizeByRole.middleware';\r\nimport { RolesEnum } from '../enums/user.enum';\r\nimport {JWTRequestI} from '../middlewares/checkJWT.middleware'\r\nimport multer from 'multer';\r\nimport { getCart } from '../controllers/product.controller';\r\n\r\n\r\nconst storage = multer.diskStorage({});\r\nconst upload = multer({storage})\r\n\r\n\r\nconst router = express.Router();\r\n\r\nrouter.post('/create', schemaValidation(createUserSchema) , createUser);\r\n\r\n\r\nrouter.delete(\"/delete/:id\", [authenticateJWT, authorizeRole(RolesEnum.ADMIN)], deleteUser);\r\n\r\nrouter.put('/update/profile/', \r\n    [authenticateJWT, authorizeRole(RolesEnum.USER), schemaValidation(updateProfileUserSchema), upload.single(\"imgProfile\")], \r\n        updateProfile);\r\n\r\nrouter.put('/update/:id', schemaValidation(updateUserSchema), updateUser );\r\n\r\nrouter.get('/profile/', [authenticateJWT, authorizeRole(RolesEnum.USER)], getProfile);\r\n\r\nrouter.get('/', getUsers);\r\n\r\n\r\nrouter.post('/setcart', (req, res) => {\r\n    const cart = req.body.cart;\r\n    const  uid = req.body.uid;\r\n    res.cookie(`cart-${uid}`, cart,{\r\n        // maxAge: 86400000, // 1 day\r\n        // httpOnly: false,\r\n        // path: '/',\r\n        maxAge: 86400000, \r\n        sameSite: 'none',\r\n        secure: true, \r\n        // domain: '.mymarketm.netlify.app', \r\n        // path: '/',\r\n    })\r\n    res.send(\"Cookie\")\r\n})\r\n\r\n\r\nrouter.get('/getcart', authenticateJWT,getCart)\r\n\r\n\r\nexport default router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2b7f31c7162a2ffab04412a506e45898f58aadd5","contentHash":"c1caa744bd9266cbf04bb877e32b5c7452110fd79ad9b5a4b67c88d7f5d7442f"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\user.controller.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\user.controller.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":134}},"4":{"start":{"line":7,"column":19},"end":{"line":7,"column":55}},"5":{"start":{"line":8,"column":15},"end":{"line":8,"column":57}},"6":{"start":{"line":9,"column":15},"end":{"line":9,"column":57}},"7":{"start":{"line":10,"column":18},"end":{"line":10,"column":63}},"8":{"start":{"line":11,"column":26},"end":{"line":11,"column":61}},"9":{"start":{"line":12,"column":19},"end":{"line":39,"column":1}},"10":{"start":{"line":13,"column":4},"end":{"line":38,"column":5}},"11":{"start":{"line":15,"column":23},"end":{"line":15,"column":78}},"12":{"start":{"line":16,"column":23},"end":{"line":16,"column":78}},"13":{"start":{"line":18,"column":8},"end":{"line":19,"column":116}},"14":{"start":{"line":19,"column":12},"end":{"line":19,"column":116}},"15":{"start":{"line":20,"column":8},"end":{"line":21,"column":116}},"16":{"start":{"line":21,"column":12},"end":{"line":21,"column":116}},"17":{"start":{"line":23,"column":24},"end":{"line":23,"column":47}},"18":{"start":{"line":24,"column":8},"end":{"line":24,"column":29}},"19":{"start":{"line":26,"column":21},"end":{"line":26,"column":87}},"20":{"start":{"line":28,"column":21},"end":{"line":28,"column":53}},"21":{"start":{"line":29,"column":8},"end":{"line":29,"column":73}},"22":{"start":{"line":31,"column":8},"end":{"line":31,"column":26}},"23":{"start":{"line":33,"column":8},"end":{"line":33,"column":71}},"24":{"start":{"line":36,"column":8},"end":{"line":36,"column":27}},"25":{"start":{"line":37,"column":8},"end":{"line":37,"column":115}},"26":{"start":{"line":40,"column":0},"end":{"line":40,"column":32}},"27":{"start":{"line":41,"column":22},"end":{"line":61,"column":1}},"28":{"start":{"line":42,"column":4},"end":{"line":60,"column":5}},"29":{"start":{"line":43,"column":21},"end":{"line":43,"column":29}},"30":{"start":{"line":44,"column":20},"end":{"line":44,"column":27}},"31":{"start":{"line":46,"column":21},"end":{"line":46,"column":75}},"32":{"start":{"line":47,"column":8},"end":{"line":48,"column":115}},"33":{"start":{"line":48,"column":12},"end":{"line":48,"column":115}},"34":{"start":{"line":49,"column":23},"end":{"line":49,"column":31}},"35":{"start":{"line":50,"column":8},"end":{"line":52,"column":9}},"36":{"start":{"line":51,"column":12},"end":{"line":51,"column":32}},"37":{"start":{"line":54,"column":24},"end":{"line":54,"column":111}},"38":{"start":{"line":55,"column":8},"end":{"line":55,"column":74}},"39":{"start":{"line":58,"column":8},"end":{"line":58,"column":27}},"40":{"start":{"line":59,"column":8},"end":{"line":59,"column":115}},"41":{"start":{"line":62,"column":0},"end":{"line":62,"column":38}},"42":{"start":{"line":63,"column":19},"end":{"line":76,"column":1}},"43":{"start":{"line":64,"column":4},"end":{"line":75,"column":5}},"44":{"start":{"line":65,"column":24},"end":{"line":65,"column":27}},"45":{"start":{"line":66,"column":21},"end":{"line":66,"column":75}},"46":{"start":{"line":67,"column":8},"end":{"line":68,"column":115}},"47":{"start":{"line":68,"column":12},"end":{"line":68,"column":115}},"48":{"start":{"line":69,"column":24},"end":{"line":69,"column":70}},"49":{"start":{"line":70,"column":8},"end":{"line":70,"column":69}},"50":{"start":{"line":73,"column":8},"end":{"line":73,"column":27}},"51":{"start":{"line":74,"column":8},"end":{"line":74,"column":115}},"52":{"start":{"line":77,"column":0},"end":{"line":77,"column":32}},"53":{"start":{"line":78,"column":19},"end":{"line":91,"column":1}},"54":{"start":{"line":79,"column":4},"end":{"line":90,"column":5}},"55":{"start":{"line":80,"column":20},"end":{"line":80,"column":33}},"56":{"start":{"line":81,"column":21},"end":{"line":81,"column":55}},"57":{"start":{"line":82,"column":8},"end":{"line":83,"column":115}},"58":{"start":{"line":83,"column":12},"end":{"line":83,"column":115}},"59":{"start":{"line":84,"column":8},"end":{"line":84,"column":64}},"60":{"start":{"line":85,"column":8},"end":{"line":85,"column":31}},"61":{"start":{"line":86,"column":8},"end":{"line":86,"column":76}},"62":{"start":{"line":89,"column":8},"end":{"line":89,"column":115}},"63":{"start":{"line":92,"column":0},"end":{"line":92,"column":32}},"64":{"start":{"line":93,"column":19},"end":{"line":100,"column":1}},"65":{"start":{"line":94,"column":4},"end":{"line":99,"column":5}},"66":{"start":{"line":95,"column":8},"end":{"line":95,"column":29}},"67":{"start":{"line":98,"column":8},"end":{"line":98,"column":115}},"68":{"start":{"line":101,"column":0},"end":{"line":101,"column":32}},"69":{"start":{"line":102,"column":17},"end":{"line":110,"column":1}},"70":{"start":{"line":103,"column":4},"end":{"line":109,"column":5}},"71":{"start":{"line":104,"column":22},"end":{"line":104,"column":71}},"72":{"start":{"line":105,"column":8},"end":{"line":105,"column":36}},"73":{"start":{"line":108,"column":8},"end":{"line":108,"column":67}},"74":{"start":{"line":111,"column":0},"end":{"line":111,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":12,"column":19},"end":{"line":12,"column":20}},"loc":{"start":{"line":12,"column":39},"end":{"line":39,"column":1}},"line":12},"2":{"name":"(anonymous_2)","decl":{"start":{"line":41,"column":22},"end":{"line":41,"column":23}},"loc":{"start":{"line":41,"column":42},"end":{"line":61,"column":1}},"line":41},"3":{"name":"(anonymous_3)","decl":{"start":{"line":63,"column":19},"end":{"line":63,"column":20}},"loc":{"start":{"line":63,"column":39},"end":{"line":76,"column":1}},"line":63},"4":{"name":"(anonymous_4)","decl":{"start":{"line":78,"column":19},"end":{"line":78,"column":20}},"loc":{"start":{"line":78,"column":39},"end":{"line":91,"column":1}},"line":78},"5":{"name":"(anonymous_5)","decl":{"start":{"line":93,"column":19},"end":{"line":93,"column":20}},"loc":{"start":{"line":93,"column":33},"end":{"line":100,"column":1}},"line":93},"6":{"name":"(anonymous_6)","decl":{"start":{"line":102,"column":17},"end":{"line":102,"column":18}},"loc":{"start":{"line":102,"column":37},"end":{"line":110,"column":1}},"line":102}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":18,"column":8},"end":{"line":19,"column":116}},"type":"if","locations":[{"start":{"line":18,"column":8},"end":{"line":19,"column":116}},{"start":{"line":18,"column":8},"end":{"line":19,"column":116}}],"line":18},"4":{"loc":{"start":{"line":20,"column":8},"end":{"line":21,"column":116}},"type":"if","locations":[{"start":{"line":20,"column":8},"end":{"line":21,"column":116}},{"start":{"line":20,"column":8},"end":{"line":21,"column":116}}],"line":20},"5":{"loc":{"start":{"line":47,"column":8},"end":{"line":48,"column":115}},"type":"if","locations":[{"start":{"line":47,"column":8},"end":{"line":48,"column":115}},{"start":{"line":47,"column":8},"end":{"line":48,"column":115}}],"line":47},"6":{"loc":{"start":{"line":50,"column":8},"end":{"line":52,"column":9}},"type":"if","locations":[{"start":{"line":50,"column":8},"end":{"line":52,"column":9}},{"start":{"line":50,"column":8},"end":{"line":52,"column":9}}],"line":50},"7":{"loc":{"start":{"line":67,"column":8},"end":{"line":68,"column":115}},"type":"if","locations":[{"start":{"line":67,"column":8},"end":{"line":68,"column":115}},{"start":{"line":67,"column":8},"end":{"line":68,"column":115}}],"line":67},"8":{"loc":{"start":{"line":82,"column":8},"end":{"line":83,"column":115}},"type":"if","locations":[{"start":{"line":82,"column":8},"end":{"line":83,"column":115}},{"start":{"line":82,"column":8},"end":{"line":83,"column":115}}],"line":82}},"s":{"0":1,"1":4,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":3,"11":3,"12":3,"13":3,"14":1,"15":2,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":0,"25":0,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":0,"34":1,"35":1,"36":0,"37":1,"38":1,"39":0,"40":0,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":0,"48":1,"49":1,"50":0,"51":0,"52":1,"53":1,"54":2,"55":2,"56":2,"57":2,"58":1,"59":1,"60":1,"61":1,"62":0,"63":1,"64":1,"65":0,"66":0,"67":0,"68":1,"69":1,"70":1,"71":1,"72":1,"73":0,"74":1},"f":{"0":4,"1":3,"2":1,"3":1,"4":2,"5":0,"6":1},"b":{"0":[1,1,1],"1":[3,1],"2":[4,4],"3":[1,2],"4":[1,1],"5":[0,1],"6":[0,1],"7":[0,1],"8":[1,1]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/user.controller.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/user.controller.ts"],"names":[],"mappings":"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","sourcesContent":["import { Request, Response } from \"express\";\r\nimport bcrypt from 'bcryptjs';\r\nimport User from \"../models/User\";\r\nimport Shop from \"../models/Shop\";\r\nimport Profile from \"../models/Profile\";\r\nimport { JWTRequestI } from \"../middlewares/checkJWT.middleware\";\r\nimport { HTTP_RESPONSE } from \"../enums/httpErrors.enum\";\r\n\r\n\r\n\r\nexport const createUser = async (req:Request, res:Response) => {\r\n    try {\r\n        // Buscar usuario\r\n        const isUser = await User.findOne({email: req.body.email});\r\n        const isShop = await Shop.findOne({email: req.body.email});\r\n\r\n        //mandar mensaje si se encuentra\r\n        if(isUser) return res.status(HTTP_RESPONSE.BadRequest).json({message:\"El usuario ya existe\"});\r\n        if(isShop) return res.status(HTTP_RESPONSE.BadRequest).json({message:\"El usuario ya existe\"});\r\n\r\n\r\n        //Crear el perfil\r\n        const profile =  new Profile();\r\n        await profile.save();\r\n\r\n\r\n        //Crear el usuario\r\n        const user = await User.create({...req.body, profile: profile._id});\r\n\r\n        \r\n        //Encriptar contrasena\r\n        const salt = bcrypt.genSaltSync();\r\n        user.password = bcrypt.hashSync(user.password, salt);\r\n\r\n\r\n        //Guardar el usuario creado\r\n        await user.save();\r\n\r\n        //Enviar el usuario guardado desde la db\r\n        res.status(HTTP_RESPONSE.Created).json(user);\r\n\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message: \"Internal server Error\"});\r\n    }\r\n}\r\n\r\nexport const updateProfile = async(req: JWTRequestI, res:Response) => {\r\n    try {\r\n        const body = req.body;\r\n        const uid = req.uid;\r\n\r\n        //Verficar usuario\r\n        const user = await User.findById(uid).populate(\"profile\");\r\n        if(!user) return res.status(HTTP_RESPONSE.NotFound).json({message:\"Usuario no encontrado\"});\r\n\r\n        const imagen = req.file;\r\n\r\n        if(imagen){\r\n            console.log(imagen)\r\n        }\r\n\r\n        //Buscar perfil del usuario / actualizar\r\n        const profile = await Profile.findByIdAndUpdate(user.profile,{...req.body}, {new: true});\r\n\r\n        \r\n\r\n        res.status(HTTP_RESPONSE.Created).json(profile)\r\n\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message: \"Internal server Error\"});\r\n    }\r\n}\r\n\r\nexport const getProfile  = async(req: JWTRequestI, res: Response) => {\r\n    try {\r\n        const {uid} = req;\r\n\r\n        const user = await User.findById(uid).populate(\"profile\");\r\n        if(!user) return res.status(HTTP_RESPONSE.NotFound).json({message:\"Usuario no encontrado\"});\r\n\r\n\r\n        const profile = await Profile.findById(user.profile);\r\n\r\n        res.status(HTTP_RESPONSE.OK).json(profile)\r\n\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message: \"Internal server Error\"});\r\n    }\r\n}\r\n\r\nexport const deleteUser = async(req:Request, res:Response) => {\r\n    try {\r\n        const uid = req.params.id;\r\n        const user = await User.findById(uid);\r\n        if(!user) return res.status(HTTP_RESPONSE.NotFound).json({message:\"Usuario no encontrado\"});\r\n        await Profile.findByIdAndDelete(user.profile);\r\n        await user.deleteOne();\r\n        res.status(HTTP_RESPONSE.Created).json(\"deleted\")\r\n    } catch (error) {\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message: \"Internal server Error\"});\r\n    }\r\n} \r\n\r\nexport const updateUser = (req:Request, res:Response) => {\r\n    try {\r\n        res.send(\"correcto\")\r\n    } catch (error) {\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message: \"Internal server Error\"});\r\n    }\r\n}\r\n\r\nexport const getUsers = async(req: Request, res:Response) => {\r\n    try {\r\n        const users = await User.find({}).select('-password');\r\n        res.status(200).json(users)\r\n    } catch (error) {\r\n        res.status(500).json({message: \"Internal server Error\"});\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"155f57c754a23bd040cc40047bff20f6ba3511bb","contentHash":"166a6d72a5b777233fa303e51d5f868df2cfb1982c0fb5b993321621a3ddb393"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\Profile.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\Profile.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":22},"end":{"line":26,"column":2}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":66}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/Profile.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/Profile.ts"],"names":[],"mappings":";;AAAA,uCAAmE;AAcnE,MAAM,aAAa,GAAG,IAAI,iBAAM,CAAW;IACvC,UAAU,EAAE;QACR,IAAI,EAAE,MAAM;KACf;IACD,IAAI,EAAE;QACF,IAAI,EAAE,MAAM;KACf;IACD,QAAQ,EAAE;QACN,IAAI,EAAE,MAAM;KACf;IACD,OAAO,EAAE;QACL,IAAI,EAAE,MAAM;KACf;IACD,QAAQ,EAAC;QACL,IAAI,EAAE,MAAM;KACf;IACD,SAAS,EAAE;QACP,IAAI,EAAE,MAAM;KACf;IACD,QAAQ,EAAE;QACN,IAAI,EAAE,MAAM;KACf;CAEJ,CAAC,CAAC;AAGH,kBAAe,IAAA,gBAAK,EAAC,SAAS,EAAE,aAAa,CAAC,CAAC","sourcesContent":["import { Schema, SchemaDefinitionProperty, model } from \"mongoose\";\r\n\r\n\r\nexport interface ProfileI {\r\n    profileImg?: string;\r\n    name: string;\r\n    lastName: string;\r\n    address: string;\r\n    publicId: string; /// id cloudinary image\r\n    longitude: number;\r\n    latitude: number;\r\n}\r\n\r\n\r\nconst ProfileSchema = new Schema<ProfileI>({\r\n    profileImg: {\r\n        type: String\r\n    },\r\n    name: {\r\n        type: String\r\n    },\r\n    lastName: {\r\n        type: String\r\n    },\r\n    address: {\r\n        type: String\r\n    },\r\n    publicId:{\r\n        type: String\r\n    },\r\n    longitude: {\r\n        type: Number\r\n    },\r\n    latitude: {\r\n        type: Number\r\n    }\r\n\r\n});\r\n\r\n\r\nexport default model('Profile', ProfileSchema);\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4559e187a011b7fa33aa7fdd2b6ac795049fb4d4","contentHash":"99eefc88e255afe37530d7df225c1a92f0f72abcb5139c0c5c20c83916ebd596"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\user.schema.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\user.schema.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":95}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":28}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":49}},"4":{"start":{"line":6,"column":0},"end":{"line":19,"column":3}},"5":{"start":{"line":20,"column":0},"end":{"line":31,"column":3}},"6":{"start":{"line":32,"column":0},"end":{"line":45,"column":3}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/user.schema.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/user.schema.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AACxB,kDAA+C;AAGlC,QAAA,gBAAgB,GAAG,OAAC,CAAC,MAAM,CAAC;IACrC,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC;QACX,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,uBAAuB,CAAC,CAAC,KAAK,CAAC;YACtD,OAAO,EAAE,qDAAqD;SACjE,CAAC;QAEF,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,4BAA4B,CAAC;aACtD,GAAG,CAAC,CAAC,EAAE,kCAAkC,CAAC;aAC1C,GAAG,CAAC,EAAE,EAAE,kCAAkC,CAAC;QAEhD,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,mCAAmC,CAAC;aAC7D,GAAG,CAAC,CAAC,EAAE,sCAAsC,CAAC;aAC9C,GAAG,CAAC,EAAE,EAAC,mCAAmC,CAAC;QAEhD,KAAK,EAAE,OAAC,CAAC,UAAU,CAAC,qBAAS,CAAC,CAAC,KAAK,EAAE,CAAC,QAAQ,CAAC,6BAA6B,CAAC;KACjF,CAAC;CACL,CAAC,CAAC;AAGU,QAAA,uBAAuB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC5C,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC;QACX,IAAI,EAAC,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,mCAAmC,CAAC;aAC5D,GAAG,CAAC,CAAC,EAAE,sCAAsC,CAAC;aAC9C,GAAG,CAAC,EAAE,EAAC,mCAAmC,CAAC,CAAC,QAAQ,EAAE;QAEvD,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,sCAAsC,CAAC;aACpE,GAAG,CAAC,CAAC,EAAE,sCAAsC,CAAC;aAC9C,GAAG,CAAC,EAAE,EAAC,mCAAmC,CAAC,CAAC,QAAQ,EAAE;QAEvD,OAAO,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,sCAAsC,CAAC;aACjE,GAAG,CAAC,EAAE,EAAC,mCAAmC,CAAC,CAAC,QAAQ,EAAE;KAC1D,CAAC;CACL,CAAC,CAAC;AAEU,QAAA,gBAAgB,GAAG,OAAC,CAAC,MAAM,CAAC;IACrC,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC;QACX,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,uBAAuB,CAAC,CAAC,KAAK,CAAC;YACtD,OAAO,EAAE,qDAAqD;SACjE,CAAC;QAEF,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,mCAAmC,CAAC;aAC7D,GAAG,CAAC,CAAC,EAAE,sCAAsC,CAAC;aAC9C,GAAG,CAAC,EAAE,EAAC,mCAAmC,CAAC;QAEhD,IAAI,EAAE,OAAC,CAAC,UAAU,CAAC,qBAAS,CAAC,CAAC,KAAK,EAAE;KACxC,CAAC;IACF,MAAM,EAAE,OAAC,CAAC,MAAM,CAAC;QACb,EAAE,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;KACxB,CAAC;CACL,CAAC,CAAA","sourcesContent":["import { z } from \"zod\";\r\nimport { RolesEnum } from \"../enums/user.enum\";\r\n\r\n\r\nexport const createUserSchema = z.object({\r\n    body: z.object({\r\n        email: z.string().nonempty(\"El email es requerido\").email({\r\n            message: \"El email no es valido, por favor intente nuevamente\",\r\n        }),\r\n    \r\n        password: z.string().nonempty(\"La contraseña es requerida\")\r\n            .min(8, \"La contraseña es demasiado corta\")\r\n            .max(20, \"La contraseña es demasiado larga\"),\r\n    \r\n        username: z.string().nonempty(\"El nombre de usuario es requerido\")\r\n            .min(3, \"Debe tener un minimo de 3 caracteres\")\r\n            .max(20,\"No debe superar los 20 caracteres\"),\r\n    \r\n        roles: z.nativeEnum(RolesEnum).array().nonempty(\"Se debe proporcionar un rol\")\r\n    })\r\n});\r\n\r\n\r\nexport const updateProfileUserSchema = z.object({\r\n    body: z.object({\r\n        name:z.string().nonempty(\"El nombre de usuario es requerido\")\r\n        .min(3, \"Debe tener un minimo de 3 caracteres\")\r\n        .max(20,\"No debe superar los 20 caracteres\").optional(),\r\n\r\n        lastName: z.string().nonempty(\"El apellido del usuario es requerido\")\r\n        .min(3, \"Debe tener un minimo de 3 caracteres\")\r\n        .max(20,\"No debe superar los 20 caracteres\").optional(),\r\n\r\n        address: z.string().min(5, \"Debe tener un minimo de 3 caracteres\")\r\n        .max(30,\"No debe superar los 20 caracteres\").optional(),\r\n    })\r\n});\r\n\r\nexport const updateUserSchema = z.object({\r\n    body: z.object({\r\n        email: z.string().nonempty(\"El email es requerido\").email({\r\n            message: \"El email no es valido, por favor intente nuevamente\",\r\n        }),\r\n        \r\n        username: z.string().nonempty(\"El nombre de usuario es requerido\")\r\n            .min(3, \"Debe tener un minimo de 3 caracteres\")\r\n            .max(20,\"No debe superar los 20 caracteres\"),\r\n    \r\n        role: z.nativeEnum(RolesEnum).array()\r\n    }),\r\n    params: z.object({\r\n        id: z.string().min(3)\r\n    })\r\n})"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8681760e09a9f7583a9da5126f7ef1920ca98515","contentHash":"247ddcb59dfcdda801c299dae5fd723793f015242f3e804ea01488c1953c5503"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\authorizeByRole.middleware.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\authorizeByRole.middleware.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":26},"end":{"line":3,"column":61}},"2":{"start":{"line":4,"column":22},"end":{"line":17,"column":1}},"3":{"start":{"line":5,"column":4},"end":{"line":16,"column":6}},"4":{"start":{"line":6,"column":25},"end":{"line":6,"column":34}},"5":{"start":{"line":7,"column":8},"end":{"line":8,"column":108}},"6":{"start":{"line":8,"column":12},"end":{"line":8,"column":108}},"7":{"start":{"line":9,"column":8},"end":{"line":15,"column":9}},"8":{"start":{"line":10,"column":12},"end":{"line":10,"column":19}},"9":{"start":{"line":13,"column":12},"end":{"line":13,"column":103}},"10":{"start":{"line":18,"column":0},"end":{"line":18,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":22},"end":{"line":4,"column":23}},"loc":{"start":{"line":4,"column":40},"end":{"line":17,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":5,"column":11},"end":{"line":5,"column":12}},"loc":{"start":{"line":5,"column":31},"end":{"line":16,"column":5}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":8},"end":{"line":8,"column":108}},"type":"if","locations":[{"start":{"line":7,"column":8},"end":{"line":8,"column":108}},{"start":{"line":7,"column":8},"end":{"line":8,"column":108}}],"line":7},"1":{"loc":{"start":{"line":7,"column":12},"end":{"line":7,"column":60}},"type":"binary-expr","locations":[{"start":{"line":7,"column":12},"end":{"line":7,"column":34}},{"start":{"line":7,"column":38},"end":{"line":7,"column":60}}],"line":7},"2":{"loc":{"start":{"line":9,"column":8},"end":{"line":15,"column":9}},"type":"if","locations":[{"start":{"line":9,"column":8},"end":{"line":15,"column":9}},{"start":{"line":9,"column":8},"end":{"line":15,"column":9}}],"line":9}},"s":{"0":1,"1":1,"2":1,"3":9,"4":17,"5":17,"6":0,"7":17,"8":17,"9":0,"10":1},"f":{"0":9,"1":17},"b":{"0":[0,17],"1":[17,17],"2":[17,0]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/authorizeByRole.middleware.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/authorizeByRole.middleware.ts"],"names":[],"mappings":";;AAEA,8DAAyD;AAQzD,MAAM,aAAa,GAAG,CAAC,YAAuB,EAAE,EAAE;IAC9C,OAAO,CAAC,GAAwB,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;QAEnE,MAAM,QAAQ,GAAG,GAAG,CAAC,KAAK,CAAC;QAE3B,IAAG,QAAQ,EAAE,MAAM,KAAK,CAAC,IAAI,QAAQ,KAAK,SAAS;YAAE,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,cAAc,EAAC,CAAC,CAAA;QAEhI,IAAI,QAAQ,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE;YACjC,IAAI,EAAE,CAAC,CAAC,kGAAkG;SAC7G;aAAM;YACH,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,iBAAiB,EAAE,CAAC,CAAC;YAC1E,4EAA4E;SAC9E;IACL,CAAC,CAAC;AACN,CAAC,CAAC;AAEF,kBAAe,aAAa,CAAC","sourcesContent":["import { Request, Response, NextFunction } from \"express\";\r\nimport { RolesEnum } from \"../enums/user.enum\";\r\nimport { HTTP_RESPONSE } from \"../enums/httpErrors.enum\";\r\n\r\nexport interface AuthenticatedRequest extends Request {\r\n    uid?: string;\r\n    username?: string;\r\n    roles?: RolesEnum[];\r\n}\r\n\r\nconst authorizeRole = (requiredRole: RolesEnum) => {\r\n    return (req:AuthenticatedRequest, res: Response, next: NextFunction) => {\r\n\r\n        const userRole = req.roles; \r\n\r\n        if(userRole?.length === 0 || userRole === undefined) return res.status(HTTP_RESPONSE.BadRequest).json({message: \"No hay roles\"})\r\n\r\n        if (userRole.includes(requiredRole)) {\r\n            next(); // El usuario tiene el rol adecuado, continúa con la siguiente función de middleware o controlador\r\n        } else {\r\n            res.status(HTTP_RESPONSE.Forbidden).json({ message: \"Acceso denegado\" }); \r\n           // El usuario no tiene el rol adecuado, devuelve un error de acceso denegado\r\n        }\r\n    };\r\n};\r\n\r\nexport default authorizeRole;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b24e63c69126a4bebe6d6e25c214d72851566e78","contentHash":"7dddf8020e40e056f88563858bed66dcdc98361e72c8bc06cd60fc312816c574"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\product.controller.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\product.controller.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":179}},"4":{"start":{"line":7,"column":18},"end":{"line":7,"column":63}},"5":{"start":{"line":8,"column":15},"end":{"line":8,"column":57}},"6":{"start":{"line":9,"column":19},"end":{"line":9,"column":38}},"7":{"start":{"line":10,"column":28},"end":{"line":10,"column":82}},"8":{"start":{"line":11,"column":19},"end":{"line":11,"column":65}},"9":{"start":{"line":12,"column":26},"end":{"line":12,"column":61}},"10":{"start":{"line":13,"column":22},"end":{"line":60,"column":1}},"11":{"start":{"line":14,"column":4},"end":{"line":59,"column":5}},"12":{"start":{"line":15,"column":35},"end":{"line":15,"column":43}},"13":{"start":{"line":16,"column":21},"end":{"line":16,"column":29}},"14":{"start":{"line":17,"column":8},"end":{"line":18,"column":114}},"15":{"start":{"line":18,"column":12},"end":{"line":18,"column":114}},"16":{"start":{"line":20,"column":23},"end":{"line":20,"column":58}},"17":{"start":{"line":21,"column":8},"end":{"line":22,"column":135}},"18":{"start":{"line":22,"column":12},"end":{"line":22,"column":135}},"19":{"start":{"line":24,"column":8},"end":{"line":25,"column":91}},"20":{"start":{"line":25,"column":12},"end":{"line":25,"column":91}},"21":{"start":{"line":26,"column":27},"end":{"line":26,"column":70}},"22":{"start":{"line":27,"column":8},"end":{"line":28,"column":140}},"23":{"start":{"line":28,"column":12},"end":{"line":28,"column":140}},"24":{"start":{"line":29,"column":8},"end":{"line":30,"column":114}},"25":{"start":{"line":30,"column":12},"end":{"line":30,"column":114}},"26":{"start":{"line":32,"column":35},"end":{"line":38,"column":10}},"27":{"start":{"line":40,"column":42},"end":{"line":40,"column":60}},"28":{"start":{"line":42,"column":27},"end":{"line":46,"column":9}},"29":{"start":{"line":48,"column":24},"end":{"line":48,"column":66}},"30":{"start":{"line":49,"column":8},"end":{"line":49,"column":29}},"31":{"start":{"line":51,"column":8},"end":{"line":51,"column":106}},"32":{"start":{"line":52,"column":33},"end":{"line":52,"column":43}},"33":{"start":{"line":53,"column":32},"end":{"line":53,"column":71}},"34":{"start":{"line":54,"column":8},"end":{"line":54,"column":82}},"35":{"start":{"line":57,"column":8},"end":{"line":57,"column":27}},"36":{"start":{"line":58,"column":8},"end":{"line":58,"column":114}},"37":{"start":{"line":61,"column":0},"end":{"line":61,"column":38}},"38":{"start":{"line":62,"column":22},"end":{"line":102,"column":1}},"39":{"start":{"line":63,"column":4},"end":{"line":101,"column":5}},"40":{"start":{"line":64,"column":26},"end":{"line":64,"column":46}},"41":{"start":{"line":65,"column":29},"end":{"line":65,"column":37}},"42":{"start":{"line":67,"column":24},"end":{"line":67,"column":67}},"43":{"start":{"line":68,"column":8},"end":{"line":69,"column":79}},"44":{"start":{"line":69,"column":12},"end":{"line":69,"column":79}},"45":{"start":{"line":72,"column":8},"end":{"line":73,"column":91}},"46":{"start":{"line":73,"column":12},"end":{"line":73,"column":91}},"47":{"start":{"line":74,"column":27},"end":{"line":74,"column":70}},"48":{"start":{"line":75,"column":8},"end":{"line":76,"column":103}},"49":{"start":{"line":76,"column":12},"end":{"line":76,"column":103}},"50":{"start":{"line":77,"column":21},"end":{"line":77,"column":29}},"51":{"start":{"line":78,"column":8},"end":{"line":92,"column":9}},"52":{"start":{"line":80,"column":12},"end":{"line":80,"column":81}},"53":{"start":{"line":81,"column":39},"end":{"line":87,"column":14}},"54":{"start":{"line":88,"column":46},"end":{"line":88,"column":64}},"55":{"start":{"line":89,"column":12},"end":{"line":89,"column":40}},"56":{"start":{"line":90,"column":12},"end":{"line":90,"column":41}},"57":{"start":{"line":91,"column":12},"end":{"line":91,"column":33}},"58":{"start":{"line":93,"column":31},"end":{"line":93,"column":115}},"59":{"start":{"line":94,"column":33},"end":{"line":94,"column":43}},"60":{"start":{"line":95,"column":32},"end":{"line":95,"column":79}},"61":{"start":{"line":96,"column":8},"end":{"line":96,"column":82}},"62":{"start":{"line":99,"column":8},"end":{"line":99,"column":27}},"63":{"start":{"line":100,"column":8},"end":{"line":100,"column":114}},"64":{"start":{"line":103,"column":0},"end":{"line":103,"column":38}},"65":{"start":{"line":104,"column":22},"end":{"line":127,"column":1}},"66":{"start":{"line":105,"column":4},"end":{"line":126,"column":5}},"67":{"start":{"line":106,"column":23},"end":{"line":106,"column":30}},"68":{"start":{"line":107,"column":26},"end":{"line":107,"column":46}},"69":{"start":{"line":109,"column":31},"end":{"line":109,"column":68}},"70":{"start":{"line":110,"column":8},"end":{"line":111,"column":116}},"71":{"start":{"line":111,"column":12},"end":{"line":111,"column":116}},"72":{"start":{"line":113,"column":26},"end":{"line":113,"column":99}},"73":{"start":{"line":113,"column":63},"end":{"line":113,"column":98}},"74":{"start":{"line":115,"column":24},"end":{"line":115,"column":76}},"75":{"start":{"line":116,"column":8},"end":{"line":118,"column":11}},"76":{"start":{"line":119,"column":8},"end":{"line":121,"column":9}},"77":{"start":{"line":120,"column":12},"end":{"line":120,"column":81}},"78":{"start":{"line":122,"column":8},"end":{"line":122,"column":73}},"79":{"start":{"line":125,"column":8},"end":{"line":125,"column":27}},"80":{"start":{"line":128,"column":0},"end":{"line":128,"column":38}},"81":{"start":{"line":129,"column":25},"end":{"line":146,"column":1}},"82":{"start":{"line":130,"column":4},"end":{"line":145,"column":5}},"83":{"start":{"line":131,"column":27},"end":{"line":131,"column":37}},"84":{"start":{"line":132,"column":8},"end":{"line":133,"column":83}},"85":{"start":{"line":133,"column":12},"end":{"line":133,"column":83}},"86":{"start":{"line":135,"column":21},"end":{"line":135,"column":58}},"87":{"start":{"line":136,"column":8},"end":{"line":137,"column":115}},"88":{"start":{"line":137,"column":12},"end":{"line":137,"column":115}},"89":{"start":{"line":138,"column":25},"end":{"line":138,"column":111}},"90":{"start":{"line":139,"column":34},"end":{"line":139,"column":65}},"91":{"start":{"line":140,"column":8},"end":{"line":140,"column":79}},"92":{"start":{"line":143,"column":8},"end":{"line":143,"column":27}},"93":{"start":{"line":144,"column":8},"end":{"line":144,"column":66}},"94":{"start":{"line":147,"column":0},"end":{"line":147,"column":44}},"95":{"start":{"line":148,"column":29},"end":{"line":158,"column":1}},"96":{"start":{"line":149,"column":4},"end":{"line":157,"column":5}},"97":{"start":{"line":150,"column":25},"end":{"line":150,"column":95}},"98":{"start":{"line":151,"column":34},"end":{"line":151,"column":65}},"99":{"start":{"line":152,"column":8},"end":{"line":152,"column":79}},"100":{"start":{"line":155,"column":8},"end":{"line":155,"column":27}},"101":{"start":{"line":156,"column":8},"end":{"line":156,"column":114}},"102":{"start":{"line":159,"column":0},"end":{"line":159,"column":52}},"103":{"start":{"line":160,"column":22},"end":{"line":175,"column":1}},"104":{"start":{"line":161,"column":4},"end":{"line":174,"column":5}},"105":{"start":{"line":162,"column":22},"end":{"line":162,"column":33}},"106":{"start":{"line":163,"column":8},"end":{"line":164,"column":133}},"107":{"start":{"line":164,"column":12},"end":{"line":164,"column":133}},"108":{"start":{"line":165,"column":28},"end":{"line":165,"column":44}},"109":{"start":{"line":166,"column":22},"end":{"line":166,"column":50}},"110":{"start":{"line":167,"column":25},"end":{"line":167,"column":123}},"111":{"start":{"line":168,"column":34},"end":{"line":168,"column":65}},"112":{"start":{"line":169,"column":8},"end":{"line":169,"column":79}},"113":{"start":{"line":172,"column":8},"end":{"line":172,"column":27}},"114":{"start":{"line":173,"column":8},"end":{"line":173,"column":114}},"115":{"start":{"line":176,"column":0},"end":{"line":176,"column":38}},"116":{"start":{"line":177,"column":16},"end":{"line":199,"column":1}},"117":{"start":{"line":178,"column":4},"end":{"line":198,"column":5}},"118":{"start":{"line":179,"column":28},"end":{"line":179,"column":58}},"119":{"start":{"line":180,"column":26},"end":{"line":180,"column":28}},"120":{"start":{"line":181,"column":24},"end":{"line":181,"column":92}},"121":{"start":{"line":181,"column":77},"end":{"line":181,"column":85}},"122":{"start":{"line":182,"column":8},"end":{"line":193,"column":9}},"123":{"start":{"line":183,"column":28},"end":{"line":183,"column":71}},"124":{"start":{"line":184,"column":32},"end":{"line":184,"column":90}},"125":{"start":{"line":184,"column":69},"end":{"line":184,"column":88}},"126":{"start":{"line":185,"column":31},"end":{"line":191,"column":13}},"127":{"start":{"line":192,"column":12},"end":{"line":192,"column":39}},"128":{"start":{"line":194,"column":8},"end":{"line":194,"column":28}},"129":{"start":{"line":197,"column":8},"end":{"line":197,"column":27}},"130":{"start":{"line":200,"column":0},"end":{"line":200,"column":26}},"131":{"start":{"line":201,"column":30},"end":{"line":210,"column":1}},"132":{"start":{"line":202,"column":30},"end":{"line":208,"column":6}},"133":{"start":{"line":203,"column":96},"end":{"line":203,"column":103}},"134":{"start":{"line":204,"column":42},"end":{"line":204,"column":46}},"135":{"start":{"line":205,"column":48},"end":{"line":205,"column":60}},"136":{"start":{"line":206,"column":8},"end":{"line":207,"column":37}},"137":{"start":{"line":209,"column":4},"end":{"line":209,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":22},"end":{"line":13,"column":23}},"loc":{"start":{"line":13,"column":42},"end":{"line":60,"column":1}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":62,"column":22},"end":{"line":62,"column":23}},"loc":{"start":{"line":62,"column":42},"end":{"line":102,"column":1}},"line":62},"3":{"name":"(anonymous_3)","decl":{"start":{"line":104,"column":22},"end":{"line":104,"column":23}},"loc":{"start":{"line":104,"column":42},"end":{"line":127,"column":1}},"line":104},"4":{"name":"(anonymous_4)","decl":{"start":{"line":113,"column":56},"end":{"line":113,"column":57}},"loc":{"start":{"line":113,"column":63},"end":{"line":113,"column":98}},"line":113},"5":{"name":"(anonymous_5)","decl":{"start":{"line":129,"column":25},"end":{"line":129,"column":26}},"loc":{"start":{"line":129,"column":45},"end":{"line":146,"column":1}},"line":129},"6":{"name":"(anonymous_6)","decl":{"start":{"line":148,"column":29},"end":{"line":148,"column":30}},"loc":{"start":{"line":148,"column":49},"end":{"line":158,"column":1}},"line":148},"7":{"name":"(anonymous_7)","decl":{"start":{"line":160,"column":22},"end":{"line":160,"column":23}},"loc":{"start":{"line":160,"column":42},"end":{"line":175,"column":1}},"line":160},"8":{"name":"(anonymous_8)","decl":{"start":{"line":177,"column":16},"end":{"line":177,"column":17}},"loc":{"start":{"line":177,"column":36},"end":{"line":199,"column":1}},"line":177},"9":{"name":"(anonymous_9)","decl":{"start":{"line":181,"column":66},"end":{"line":181,"column":67}},"loc":{"start":{"line":181,"column":77},"end":{"line":181,"column":85}},"line":181},"10":{"name":"(anonymous_10)","decl":{"start":{"line":184,"column":61},"end":{"line":184,"column":62}},"loc":{"start":{"line":184,"column":69},"end":{"line":184,"column":88}},"line":184},"11":{"name":"(anonymous_11)","decl":{"start":{"line":201,"column":30},"end":{"line":201,"column":31}},"loc":{"start":{"line":201,"column":44},"end":{"line":210,"column":1}},"line":201},"12":{"name":"(anonymous_12)","decl":{"start":{"line":202,"column":43},"end":{"line":202,"column":44}},"loc":{"start":{"line":202,"column":56},"end":{"line":208,"column":5}},"line":202}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":17,"column":8},"end":{"line":18,"column":114}},"type":"if","locations":[{"start":{"line":17,"column":8},"end":{"line":18,"column":114}},{"start":{"line":17,"column":8},"end":{"line":18,"column":114}}],"line":17},"4":{"loc":{"start":{"line":21,"column":8},"end":{"line":22,"column":135}},"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":22,"column":135}},{"start":{"line":21,"column":8},"end":{"line":22,"column":135}}],"line":21},"5":{"loc":{"start":{"line":24,"column":8},"end":{"line":25,"column":91}},"type":"if","locations":[{"start":{"line":24,"column":8},"end":{"line":25,"column":91}},{"start":{"line":24,"column":8},"end":{"line":25,"column":91}}],"line":24},"6":{"loc":{"start":{"line":27,"column":8},"end":{"line":28,"column":140}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":28,"column":140}},{"start":{"line":27,"column":8},"end":{"line":28,"column":140}}],"line":27},"7":{"loc":{"start":{"line":29,"column":8},"end":{"line":30,"column":114}},"type":"if","locations":[{"start":{"line":29,"column":8},"end":{"line":30,"column":114}},{"start":{"line":29,"column":8},"end":{"line":30,"column":114}}],"line":29},"8":{"loc":{"start":{"line":68,"column":8},"end":{"line":69,"column":79}},"type":"if","locations":[{"start":{"line":68,"column":8},"end":{"line":69,"column":79}},{"start":{"line":68,"column":8},"end":{"line":69,"column":79}}],"line":68},"9":{"loc":{"start":{"line":72,"column":8},"end":{"line":73,"column":91}},"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":73,"column":91}},{"start":{"line":72,"column":8},"end":{"line":73,"column":91}}],"line":72},"10":{"loc":{"start":{"line":75,"column":8},"end":{"line":76,"column":103}},"type":"if","locations":[{"start":{"line":75,"column":8},"end":{"line":76,"column":103}},{"start":{"line":75,"column":8},"end":{"line":76,"column":103}}],"line":75},"11":{"loc":{"start":{"line":78,"column":8},"end":{"line":92,"column":9}},"type":"if","locations":[{"start":{"line":78,"column":8},"end":{"line":92,"column":9}},{"start":{"line":78,"column":8},"end":{"line":92,"column":9}}],"line":78},"12":{"loc":{"start":{"line":78,"column":12},"end":{"line":78,"column":29}},"type":"binary-expr","locations":[{"start":{"line":78,"column":12},"end":{"line":78,"column":16}},{"start":{"line":78,"column":20},"end":{"line":78,"column":29}}],"line":78},"13":{"loc":{"start":{"line":110,"column":8},"end":{"line":111,"column":116}},"type":"if","locations":[{"start":{"line":110,"column":8},"end":{"line":111,"column":116}},{"start":{"line":110,"column":8},"end":{"line":111,"column":116}}],"line":110},"14":{"loc":{"start":{"line":113,"column":63},"end":{"line":113,"column":98}},"type":"binary-expr","locations":[{"start":{"line":113,"column":63},"end":{"line":113,"column":93}},{"start":{"line":113,"column":97},"end":{"line":113,"column":98}}],"line":113},"15":{"loc":{"start":{"line":119,"column":8},"end":{"line":121,"column":9}},"type":"if","locations":[{"start":{"line":119,"column":8},"end":{"line":121,"column":9}},{"start":{"line":119,"column":8},"end":{"line":121,"column":9}}],"line":119},"16":{"loc":{"start":{"line":132,"column":8},"end":{"line":133,"column":83}},"type":"if","locations":[{"start":{"line":132,"column":8},"end":{"line":133,"column":83}},{"start":{"line":132,"column":8},"end":{"line":133,"column":83}}],"line":132},"17":{"loc":{"start":{"line":136,"column":8},"end":{"line":137,"column":115}},"type":"if","locations":[{"start":{"line":136,"column":8},"end":{"line":137,"column":115}},{"start":{"line":136,"column":8},"end":{"line":137,"column":115}}],"line":136},"18":{"loc":{"start":{"line":163,"column":8},"end":{"line":164,"column":133}},"type":"if","locations":[{"start":{"line":163,"column":8},"end":{"line":164,"column":133}},{"start":{"line":163,"column":8},"end":{"line":164,"column":133}}],"line":163},"19":{"loc":{"start":{"line":181,"column":24},"end":{"line":181,"column":92}},"type":"cond-expr","locations":[{"start":{"line":181,"column":38},"end":{"line":181,"column":87}},{"start":{"line":181,"column":90},"end":{"line":181,"column":92}}],"line":181}},"s":{"0":1,"1":4,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":2,"12":2,"13":2,"14":2,"15":1,"16":1,"17":1,"18":0,"19":1,"20":0,"21":1,"22":1,"23":0,"24":1,"25":0,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":0,"36":0,"37":1,"38":1,"39":4,"40":4,"41":4,"42":4,"43":4,"44":1,"45":3,"46":1,"47":2,"48":2,"49":1,"50":1,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":1,"60":1,"61":1,"62":0,"63":0,"64":1,"65":1,"66":1,"67":1,"68":1,"69":1,"70":1,"71":0,"72":1,"73":8,"74":1,"75":1,"76":1,"77":1,"78":1,"79":0,"80":1,"81":1,"82":2,"83":2,"84":2,"85":1,"86":1,"87":1,"88":0,"89":1,"90":1,"91":1,"92":0,"93":0,"94":1,"95":1,"96":1,"97":1,"98":1,"99":1,"100":0,"101":0,"102":1,"103":1,"104":1,"105":1,"106":1,"107":0,"108":1,"109":1,"110":1,"111":1,"112":1,"113":0,"114":0,"115":1,"116":1,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":1,"131":1,"132":3,"133":14,"134":14,"135":14,"136":14,"137":3},"f":{"0":4,"1":2,"2":4,"3":1,"4":8,"5":2,"6":1,"7":1,"8":0,"9":0,"10":0,"11":3,"12":14},"b":{"0":[1,1,1],"1":[4,0],"2":[4,4],"3":[1,1],"4":[0,1],"5":[0,1],"6":[0,1],"7":[0,1],"8":[1,3],"9":[1,2],"10":[1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[8,1],"15":[1,0],"16":[1,1],"17":[0,1],"18":[0,1],"19":[0,0]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/product.controller.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/product.controller.ts"],"names":[],"mappings":"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","sourcesContent":["import {  Request, Response } from \"express\";\r\nimport Product, { ProductI } from \"../models/Product\";\r\nimport Shop, { ShopI } from \"../models/Shop\";\r\nimport { isObjectIdOrHexString } from \"mongoose\";\r\nimport cloudinary from \"../utils/cloudinary.config\";\r\nimport { AuthenticatedRequest } from \"../middlewares/authorizeByRole.middleware\";\r\nimport Category, { CategoryI } from \"../models/Category\";\r\nimport { HTTP_RESPONSE } from \"../enums/httpErrors.enum\";\r\nimport { JWTRequestI } from \"../middlewares/checkJWT.middleware\";\r\n\r\n\r\n\r\nexport const createProduct = async (req: Request,res: Response) => {\r\n    try {\r\n\r\n        \r\n        const {shop, category} = req.body;\r\n\r\n        const file = req.file;\r\n\r\n        if(!file) return res.status(HTTP_RESPONSE.NotFound).json({message: \"Imagen no encontrada\"});\r\n\r\n        //Verficar el id de la tienda --- pasar a middleware\r\n        const isShop = await Shop.findById(shop);\r\n        if(!isShop) return res.status(HTTP_RESPONSE.NotFound).json({message:`Comercio con el id: ${shop} no encontrado`});\r\n\r\n        //Verificar el id de la categoria --- pasar a middleware\r\n        if(!isObjectIdOrHexString(category)) return res.status(400).json({message:`id: ${category} formato incorrecto`});\r\n        const isCategory = await Category.findById(category);\r\n        if(!isCategory) return res.status(HTTP_RESPONSE.NotFound).json({message:`Categoria con el id: ${category} no encontrado`});\r\n\r\n\r\n        if(!req.file?.path) return  res.status(HTTP_RESPONSE.NotFound).json({message: \"Imagen no encontrada\"});\r\n        \r\n        //Subir imagen cloudinary\r\n        const cloudinaryResponse = await cloudinary.uploader.upload(req.file?.path, {\r\n            resource_type: \"auto\",\r\n            transformation: [\r\n                {height: 400, crop: \"scale\"},\r\n                {fetch_format: \"webp\"}\r\n            ]\r\n        });\r\n\r\n        // Rescatar url y id de la imagen\r\n        const {secure_url, public_id} = cloudinaryResponse;\r\n\r\n        ///Producto con todos sus atributos\r\n        const newProduct:ProductI = {\r\n            ...req.body,\r\n            imgUrl: secure_url,\r\n            publicId: public_id\r\n        }\r\n\r\n        //Crear producto\r\n        const product =  await Product.create(newProduct);\r\n        await product.save(); //Guardar producto\r\n\r\n        //Guardar el product en el array de product del comercio\r\n        await Shop.findByIdAndUpdate(\r\n                shop,\r\n                {$push: {products: product._id}},\r\n                {new: true}\r\n        )\r\n        const {categoryName} = isCategory;\r\n\r\n        const productResponse = { ...product.toObject(), categoryName};\r\n\r\n        res.status(HTTP_RESPONSE.Created).json(productResponse);\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message:\"Interal server error\"})\r\n    }\r\n}\r\n\r\nexport const updateProduct = async(req: AuthenticatedRequest, res: Response) => {\r\n    try {\r\n        const productId = req.params.productId;\r\n        const {category} = req.body;\r\n\r\n        // TODO: pasar a middleware\r\n        const product = await Product.findById(productId);\r\n        if(!product) return res.status(404).json({message:\"Producto no encontrado\"});\r\n\r\n        // TODO: pasar a middleware\r\n        // Encontrar categoria\r\n        if(!isObjectIdOrHexString(category)) return res.status(400).json({message:`id: ${category} formato incorrecto`});\r\n        const isCategory = await Category.findById(category);\r\n        if(!isCategory) return res.status(404).json({message:`Categoria con el id: ${category} no encontrado`});\r\n\r\n        const file = req.file; // imagen\r\n\r\n        if(file && file.path){\r\n            //eliminar image anterior\r\n            await cloudinary.uploader.destroy(product.publicId);\r\n            const cloudinaryResponse = await cloudinary.uploader.upload(file.path, {\r\n                resource_type: \"auto\",\r\n                transformation: [\r\n                    {height: 400, crop: \"scale\"},\r\n                    {fetch_format: \"webp\"}\r\n                ]\r\n            });\r\n\r\n            const {secure_url, public_id} = cloudinaryResponse;\r\n            product.imgUrl = secure_url;\r\n            product.publicId = public_id;\r\n            await product.save();\r\n        }\r\n\r\n        const productUpdated= await Product.findByIdAndUpdate(productId, {...req.body}, {new: true});\r\n        const {categoryName} = isCategory;\r\n\r\n        const productResponse = { ...productUpdated?.toObject(), categoryName};\r\n\r\n        res.status(HTTP_RESPONSE.Created).json(productResponse)    \r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message:\"Interal server error\"})\r\n    }\r\n}\r\n\r\nexport const deleteProduct = async(req: AuthenticatedRequest, res: Response) => {\r\n    try {\r\n        const userId:any =  req.uid;\r\n        const productId = req.params.productId;\r\n        \r\n        //Verificar si la tienda existe por ende el producto  --- pasar a middleware\r\n        const isOwnerProduct = await Shop.findById(userId);\r\n        if(!isOwnerProduct) return res.status(HTTP_RESPONSE.NotFound).json({message: \"Producto no encontrado\"});\r\n\r\n        //Verificar si el producto a elminar pertenece a la tienda\r\n        const isProduct = isOwnerProduct?.products.find((p:any) => p._id.toString() === productId && p);\r\n\r\n\r\n        //Eliminar producto\r\n        const product = await Product.findByIdAndDelete(isProduct);\r\n\r\n        await Shop.findByIdAndUpdate(userId, {\r\n            $pull: { products: isProduct }, // Elimina el productId del array products\r\n        });\r\n\r\n        if(product?.publicId){\r\n            await cloudinary.uploader.destroy(product.publicId);\r\n        }\r\n\r\n        return res.json({message: \"Producto eliminado correctamente\"})\r\n\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n}\r\n\r\n\r\nexport const getProductByShop = async(  req: Request, res: Response) => {\r\n    try {\r\n        const {shopId} = req.params;\r\n\r\n        if(!isObjectIdOrHexString(shopId)) return res.status(404).json({message:\"Id del comercio incorrecto\"});\r\n\r\n        //Buscar el comercio por el id --- pasar a middleware\r\n        const shop = await Shop.findById(shopId);\r\n        if(!shop) return res.status(HTTP_RESPONSE.NotFound).json({message:\"El comercio no existe\"});\r\n\r\n        const products = await Product.find({'shop': shopId}).populate(\"shop\").populate(\"category\");\r\n\r\n        const formateddProducts = productResponseFormat(products);\r\n\r\n\r\n\r\n        res.status(HTTP_RESPONSE.OK).json(formateddProducts);\r\n\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(500).json({message:\"Interal server error\"})\r\n    }\r\n}\r\n\r\n\r\nexport const getAllProductsByShop = async (req: Request, res: Response) => {\r\n    try {\r\n\r\n        const products = await Product.find({}).populate(\"shop\").populate(\"category\");\r\n\r\n        const formateddProducts = productResponseFormat(products);\r\n    \r\n        res.status(HTTP_RESPONSE.OK).json(formateddProducts);\r\n    } catch (error) {\r\n        console.log(error);\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({ message: \"Interal server error\" });\r\n    }\r\n};\r\n\r\n\r\nexport const searchProduct = async(req:Request, res:Response) => {\r\n    try {\r\n        const query = req.query.q;\r\n        if(!query) return res.status(HTTP_RESPONSE.NotFound).json({message: \"No se proporciono parametro de busqueda\"});\r\n        const searchValue = query.toString();\r\n                \r\n        const regex = new RegExp(searchValue, 'i');\r\n\r\n        const products = await Product.find({'title': {$regex: regex}}).populate(\"shop\").populate(\"category\");\r\n\r\n        \r\n        const formateddProducts = productResponseFormat(products);\r\n\r\n    \r\n        res.status(HTTP_RESPONSE.OK).json(formateddProducts);\r\n\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({ message: \"Interal server error\" });\r\n    }\r\n}\r\n\r\n\r\nexport const getCart = async(req:JWTRequestI, res:Response) => {\r\n    try {\r\n        const cookiesCart = req.cookies[`cart-${req.uid}`]\r\n        const cartArray:ProductI[] = [];\r\n        const cartIds = cookiesCart ? JSON.parse(cookiesCart).map((cart:{_id:string}) => (cart._id)) : [];\r\n        for (const idProduct of cartIds) {\r\n            const product = await Product.findById(idProduct);\r\n            const productInfo = JSON.parse(cookiesCart).find((p:ProductI) => (p._id === idProduct));\r\n\r\n            const newProduct = {\r\n                ...productInfo,\r\n                price: product?.price,\r\n                stock: product?.stock,\r\n                title: product?.title,\r\n                imgUrl: product?.imgUrl\r\n            }\r\n            cartArray.push(newProduct);\r\n        }\r\n\r\n        res.send(cartArray);\r\n        \r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n}\r\n\r\n\r\nconst productResponseFormat = (products: ProductI[]) => {\r\n    const formattedProducts = products.map((product:ProductI) => {\r\n        const {_id, title, price, description, stock, shop, imgUrl, category:categoryInfo} = product;\r\n\r\n        const {shopName, _id:shopId} = shop as ShopI;\r\n        const {categoryName, _id:category} = categoryInfo as CategoryI;\r\n\r\n        return {_id, title, price, description, imgUrl,  stock, shopName, shopId , \r\n            categoryName, category}\r\n    })\r\n    return formattedProducts;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fd1b08b4fe1efa9b60a989708a17f58755b8b831","contentHash":"d2837808044cec43b994048be88035011f457096d5060065792d67c921891eec"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\Product.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\Product.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":22},"end":{"line":39,"column":2}},"3":{"start":{"line":40,"column":0},"end":{"line":40,"column":66}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/Product.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/Product.ts"],"names":[],"mappings":";;AAAA,uCAAmE;AAgBnE,MAAM,aAAa,GAAG,IAAK,iBAAM,CAAW;IACxC,KAAK,EAAE;QACH,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,KAAK,EAAE;QACH,IAAI,EAAE,MAAM;QACZ,OAAO,EAAE,IAAI;KAChB;IACD,WAAW,EAAC;QACR,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;KAClB;IACD,MAAM,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,QAAQ,EAAE;QACN,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,KAAK,EAAC;QACF,IAAI,EAAE,MAAM;QACZ,OAAO,EAAE,IAAI;KAChB;IACD,IAAI,EAAC;QACD,IAAI,EAAE,iBAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,GAAG,EAAE,MAAM;QACX,QAAQ,EAAE,IAAI;KACjB;IACD,QAAQ,EAAC;QACL,IAAI,EAAE,iBAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,GAAG,EAAE,UAAU;QACf,QAAQ,EAAE,IAAI;KACjB;CACJ,CAAC,CAAC;AAEH,kBAAe,IAAA,gBAAK,EAAC,SAAS,EAAE,aAAa,CAAC,CAAC","sourcesContent":["import { Schema, SchemaDefinitionProperty, model } from \"mongoose\";\r\n\r\nexport interface ProductI{\r\n    _id?: string,\r\n    title:string,\r\n    description: string,\r\n    imgUrl: string,\r\n    price: Number,\r\n    stock: Number,\r\n    shop: SchemaDefinitionProperty<string>,\r\n    publicId: string,\r\n    category: SchemaDefinitionProperty<string>,\r\n    categoryName?: string,\r\n}\r\n\r\n\r\nconst ProductSchema = new  Schema<ProductI>({\r\n    title: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    price: {\r\n        type: Number,\r\n        require: true\r\n    },\r\n    description:{\r\n        type: String,\r\n        required: false\r\n    },\r\n    imgUrl: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    publicId: {\r\n        type: String,\r\n        required: true,\r\n    },\r\n    stock:{\r\n        type: Number,\r\n        require: true\r\n    },\r\n    shop:{\r\n        type: Schema.Types.ObjectId,\r\n        ref: \"Shop\",\r\n        required: true,\r\n    },\r\n    category:{\r\n        type: Schema.Types.ObjectId,\r\n        ref: \"Category\",\r\n        required: true,\r\n    }\r\n});\r\n\r\nexport default model('Product', ProductSchema);"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"dc798b74925dc4ea96bb66a8310ee7825f9a87d3","contentHash":"7501b18d99f94173fbc006a5c9d7e29e4060390023a516b06be1f336696ea2a8"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\utils\\cloudinary.config.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\utils\\cloudinary.config.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":21},"end":{"line":6,"column":42}},"4":{"start":{"line":7,"column":17},"end":{"line":7,"column":51}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":26}},"6":{"start":{"line":10,"column":0},"end":{"line":15,"column":3}},"7":{"start":{"line":16,"column":0},"end":{"line":16,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1},"f":{"0":1},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/utils/cloudinary.config.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/utils/cloudinary.config.ts"],"names":[],"mappings":";;;;;AAAA,2CAA4C;AAC5C,oDAA4B;AAE5B,SAAS;AACT,gBAAM,CAAC,MAAM,EAAE,CAAC;AAEhB,eAAU,CAAC,MAAM,CAAC;IAEd,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU;IAClC,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,SAAS;IAC9B,UAAU,EAAC,OAAO,CAAC,GAAG,CAAC,YAAY;IACnC,MAAM,EAAE,IAAI;CACf,CAAC,CAAA;AAGF,kBAAe,eAAU,CAAC","sourcesContent":["import {v2 as cloudinary} from 'cloudinary';    \r\nimport dotenv from 'dotenv';\r\n\r\n// Config\r\ndotenv.config();\r\n\r\ncloudinary.config({\r\n\r\n    cloud_name: process.env.CLOUD_NAME,\r\n    api_key: process.env.CLOUD_KEY,\r\n    api_secret:process.env.CLOUD_SECRET,\r\n    secure: true,\r\n})\r\n\r\n\r\nexport default cloudinary;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bc0f685251112a7d395fc68cd4771f91152cc02a","contentHash":"a59ffb1f4b0edabf4fabadac60b65d0d8aeff4d9312439349737dc397e193e2e"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\Category.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\models\\Category.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":23},"end":{"line":9,"column":2}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":68}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/Category.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/models/Category.ts"],"names":[],"mappings":";;AAAA,uCAAyC;AAWzC,MAAM,cAAc,GAAG,IAAI,iBAAM,CAAY;IACzC,YAAY,EAAC;QACT,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;CACJ,CAAC,CAAA;AAGF,kBAAe,IAAA,gBAAK,EAAC,UAAU,EAAE,cAAc,CAAC,CAAC","sourcesContent":["import { Schema, model } from \"mongoose\";\r\n\r\n\r\n\r\nexport interface CategoryI{\r\n    _id?: string;\r\n    categoryName: string;\r\n}\r\n\r\n\r\n\r\nconst CategorySchema = new Schema<CategoryI>({\r\n    categoryName:{\r\n        type: String,\r\n        required: true\r\n    }\r\n})\r\n\r\n\r\nexport default model('Category', CategorySchema);\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"807739d1b45b36815a2089d4c72aee2a828032e1","contentHash":"b452b4fa7a654acca497d9ec30790faa5a188dfadfa6a93b1cd5d92924e5a828"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\shop.routes.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\shop.routes.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":18},"end":{"line":6,"column":36}},"4":{"start":{"line":7,"column":22},"end":{"line":7,"column":55}},"5":{"start":{"line":8,"column":37},"end":{"line":8,"column":89}},"6":{"start":{"line":9,"column":26},"end":{"line":9,"column":67}},"7":{"start":{"line":10,"column":30},"end":{"line":10,"column":92}},"8":{"start":{"line":11,"column":30},"end":{"line":11,"column":92}},"9":{"start":{"line":12,"column":15},"end":{"line":12,"column":38}},"10":{"start":{"line":13,"column":0},"end":{"line":13,"column":201}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":44}},"12":{"start":{"line":15,"column":0},"end":{"line":15,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1},"f":{"0":2},"b":{"0":[1,1,1],"1":[2,0],"2":[2,2]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/shop.routes.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/shop.routes.ts"],"names":[],"mappings":";;;;;AAAA,qCAA+B;AAC/B,wDAA0D;AAC1D,0FAA6E;AAC7E,oEAAsE;AACtE,6FAA0D;AAC1D,6FAA0D;AAI1D,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAGxB,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,IAAA,6CAAgB,EAAC,8BAAgB,CAAC,EAAC,6BAAQ,EAAE,6BAAQ,CAAC,EAAE,4BAAU,CAAC,CAAC;AAE5F,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,0BAAQ,CAAC,CAAC;AAE1B,kBAAe,MAAM,CAAC","sourcesContent":["import {Router} from 'express';\r\nimport { createShopSchema } from '../schemas/shop.schema';\r\nimport { schemaValidation } from '../middlewares/schemaValidator.middleware';\r\nimport { createShop, getShops } from '../controllers/shop.controller';\r\nimport findShop from '../middlewares/findShop.middleware';\r\nimport findUser from '../middlewares/findUser.middleware';\r\n\r\n\r\n\r\nconst router = Router();\r\n\r\n\r\nrouter.post('/create', [schemaValidation(createShopSchema),findShop, findUser], createShop);\r\n\r\nrouter.get('/', getShops);\r\n\r\nexport default router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c2e3c27e4d4ab00cab0fc0afb4e039d9c44c73a1","contentHash":"855664011ea1ba484c7bc358a511343bcee5936dfbf30a54b2935a9453087d94"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\shop.schema.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\shop.schema.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":34}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":28}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":49}},"4":{"start":{"line":6,"column":0},"end":{"line":22,"column":3}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/shop.schema.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/shop.schema.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AACxB,kDAA+C;AAIlC,QAAA,gBAAgB,GAAE,OAAC,CAAC,MAAM,CAAC;IACpC,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC;QACX,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,uBAAuB,CAAC,CAAC,KAAK,CAAC;YACtD,OAAO,EAAE,qDAAqD;SACjE,CAAC;QAEF,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,4BAA4B,CAAC;aACtD,GAAG,CAAC,CAAC,EAAE,kCAAkC,CAAC;aAC1C,GAAG,CAAC,EAAE,EAAE,kCAAkC,CAAC;QAEhD,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,mCAAmC,CAAC;aAC7D,GAAG,CAAC,CAAC,EAAE,sCAAsC,CAAC;aAC9C,GAAG,CAAC,EAAE,EAAC,mCAAmC,CAAC;QAEhD,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,qCAAqC,CAAC;aACnE,GAAG,CAAC,CAAC,EAAE,sCAAsC,CAAC;aAC9C,GAAG,CAAC,EAAE,EAAC,mCAAmC,CAAC;QAE5C,KAAK,EAAE,OAAC,CAAC,UAAU,CAAC,qBAAS,CAAC,CAAC,KAAK,EAAE,CAAC,QAAQ,CAAC,6BAA6B,CAAC;KACjF,CAAC;CACL,CAAC,CAAC","sourcesContent":["import { z } from \"zod\";\r\nimport { RolesEnum } from \"../enums/user.enum\";\r\n\r\n\r\n\r\nexport const createShopSchema =z.object({\r\n    body: z.object({\r\n        email: z.string().nonempty(\"El email es requerido\").email({\r\n            message: \"El email no es valido, por favor intente nuevamente\",\r\n        }),\r\n    \r\n        password: z.string().nonempty(\"La contraseña es requerida\")\r\n            .min(8, \"La contraseña es demasiado corta\")\r\n            .max(20, \"La contraseña es demasiado larga\"),\r\n    \r\n        username: z.string().nonempty(\"El nombre de usuario es requerido\")\r\n            .min(3, \"Debe tener un minimo de 3 caracteres\")\r\n            .max(20,\"No debe superar los 20 caracteres\"),\r\n        \r\n        shopName: z.string().nonempty(\"El nombre de la tienda es requerido\")\r\n        .min(3, \"Debe tener un minimo de 3 caracteres\")\r\n        .max(20,\"No debe superar los 20 caracteres\"),\r\n    \r\n        roles: z.nativeEnum(RolesEnum).array().nonempty(\"Se debe proporcionar un rol\")\r\n    })\r\n});\r\n\r\n\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fbc2560af791e6579b7abdd9d813d7ac6a530fa1","contentHash":"d6d1f68fad51aa77cc82c3a7a5d39f2601a5541bca632e2d28aa9b9477c309e9"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\shop.controller.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\shop.controller.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":47}},"4":{"start":{"line":7,"column":19},"end":{"line":7,"column":55}},"5":{"start":{"line":8,"column":15},"end":{"line":8,"column":57}},"6":{"start":{"line":9,"column":26},"end":{"line":9,"column":61}},"7":{"start":{"line":10,"column":19},"end":{"line":26,"column":1}},"8":{"start":{"line":11,"column":4},"end":{"line":25,"column":5}},"9":{"start":{"line":13,"column":21},"end":{"line":13,"column":58}},"10":{"start":{"line":15,"column":21},"end":{"line":15,"column":53}},"11":{"start":{"line":16,"column":8},"end":{"line":16,"column":73}},"12":{"start":{"line":18,"column":8},"end":{"line":18,"column":26}},"13":{"start":{"line":20,"column":8},"end":{"line":20,"column":71}},"14":{"start":{"line":23,"column":8},"end":{"line":23,"column":27}},"15":{"start":{"line":24,"column":8},"end":{"line":24,"column":115}},"16":{"start":{"line":27,"column":0},"end":{"line":27,"column":32}},"17":{"start":{"line":28,"column":17},"end":{"line":37,"column":1}},"18":{"start":{"line":29,"column":4},"end":{"line":36,"column":5}},"19":{"start":{"line":30,"column":22},"end":{"line":30,"column":83}},"20":{"start":{"line":31,"column":8},"end":{"line":31,"column":67}},"21":{"start":{"line":34,"column":8},"end":{"line":34,"column":27}},"22":{"start":{"line":35,"column":8},"end":{"line":35,"column":115}},"23":{"start":{"line":38,"column":0},"end":{"line":38,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":19},"end":{"line":10,"column":20}},"loc":{"start":{"line":10,"column":39},"end":{"line":26,"column":1}},"line":10},"2":{"name":"(anonymous_2)","decl":{"start":{"line":28,"column":17},"end":{"line":28,"column":18}},"loc":{"start":{"line":28,"column":37},"end":{"line":37,"column":1}},"line":28}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":1,"18":1,"19":1,"20":1,"21":0,"22":0,"23":1},"f":{"0":2,"1":0,"2":1},"b":{"0":[1,1,1],"1":[1,1],"2":[2,2]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/shop.controller.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/shop.controller.ts"],"names":[],"mappings":";;;;;;AACA,wDAA8B;AAC9B,0DAAkC;AAClC,8DAAyD;AAKlD,MAAM,UAAU,GAAG,KAAK,EAAE,GAAY,EAAE,GAAa,EAAE,EAAE;IAC5D,IAAI;QAEA,mBAAmB;QACnB,MAAM,IAAI,GAAG,MAAM,cAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAGzC,sBAAsB;QACtB,MAAM,IAAI,GAAG,kBAAM,CAAC,WAAW,EAAE,CAAC;QAClC,IAAI,CAAC,QAAQ,GAAG,kBAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAGrD,4BAA4B;QAC5B,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;QAElB,yCAAyC;QACzC,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAEhD;IAAC,OAAO,KAAK,EAAE;QACZ,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,uBAAuB,EAAC,CAAC,CAAC;KAC1F;AACL,CAAC,CAAA;AAtBY,QAAA,UAAU,cAsBtB;AAGM,MAAM,QAAQ,GAAG,KAAK,EAAC,GAAa,EAAE,GAAa,EAAE,EAAE;IAC1D,IAAI;QACA,MAAM,KAAK,GAAG,MAAM,cAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QAElE,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC5C;IAAC,OAAO,KAAK,EAAE;QACZ,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,uBAAuB,EAAC,CAAC,CAAC;KAC1F;AACL,CAAC,CAAA;AATY,QAAA,QAAQ,YASpB","sourcesContent":["import {Request, Response} from 'express';\r\nimport bcrypt from 'bcryptjs';\r\nimport Shop from \"../models/Shop\";\r\nimport { HTTP_RESPONSE } from '../enums/httpErrors.enum';\r\n\r\n\r\n\r\n\r\nexport const createShop = async (req: Request, res: Response) => {\r\n    try {\r\n\r\n        //Crear el comercio\r\n        const shop = await Shop.create(req.body);\r\n\r\n        \r\n        //Encriptar contrasena\r\n        const salt = bcrypt.genSaltSync();\r\n        shop.password = bcrypt.hashSync(shop.password, salt);\r\n\r\n\r\n        //Guardar el comercio creado\r\n        await shop.save();\r\n\r\n        //Enviar el comercio guardado desde la db\r\n        res.status(HTTP_RESPONSE.Created).json(shop);\r\n\r\n    } catch (error) {\r\n        console.log(error);\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message: \"Internal server Error\"});\r\n    }\r\n}\r\n\r\n\r\nexport const getShops = async(req : Request, res: Response) => {\r\n    try {\r\n        const shops = await Shop.find({}).select(\"id\").select(\"username\");\r\n\r\n        res.status(HTTP_RESPONSE.OK).json(shops);\r\n    } catch (error) {\r\n        console.log(error);\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message: \"Internal server Error\"});\r\n    }\r\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5722313097c430aa09568a2c78c257fe984e947f","contentHash":"f89a70f2f0502d7e4bb6323fcb24aa618a9155a847ddac85108bba95aedf903c"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\findShop.middleware.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\findShop.middleware.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":15},"end":{"line":6,"column":57}},"4":{"start":{"line":7,"column":26},"end":{"line":7,"column":61}},"5":{"start":{"line":8,"column":17},"end":{"line":21,"column":1}},"6":{"start":{"line":9,"column":4},"end":{"line":20,"column":5}},"7":{"start":{"line":10,"column":23},"end":{"line":10,"column":78}},"8":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"9":{"start":{"line":12,"column":12},"end":{"line":12,"column":117}},"10":{"start":{"line":14,"column":8},"end":{"line":14,"column":15}},"11":{"start":{"line":18,"column":8},"end":{"line":18,"column":29}},"12":{"start":{"line":19,"column":8},"end":{"line":19,"column":119}},"13":{"start":{"line":22,"column":0},"end":{"line":22,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":17},"end":{"line":8,"column":18}},"loc":{"start":{"line":8,"column":43},"end":{"line":21,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"type":"if","locations":[{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},{"start":{"line":11,"column":8},"end":{"line":13,"column":9}}],"line":11}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1},"f":{"0":1,"1":0},"b":{"0":[1,1,1],"1":[1,0],"2":[1,1],"3":[0,0]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/findShop.middleware.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/findShop.middleware.ts"],"names":[],"mappings":";;;;;AACA,0DAAkC;AAClC,8DAAyD;AAIzD,MAAM,QAAQ,GAAG,KAAK,EAAE,GAAW,EAAE,GAAY,EAAE,IAAiB,EAAE,EAAE;IAChE,IAAI;QACJ,MAAM,MAAM,GAAG,MAAM,cAAI,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;QAC7D,IAAI,MAAM,EAAE;YACR,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,uBAAuB,EAAE,CAAC,CAAC;SAC1F;QACD,IAAI,EAAE,CAAC;KACN;IAAC,OAAO,KAAK,EAAE;QAChB,mBAAmB;QACnB,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACrB,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,oBAAoB,EAAE,KAAK,EAAE,CAAC,CAAC;KAC5F;AACT,CAAC,CAAC;AAGF,kBAAe,QAAQ,CAAC","sourcesContent":["import { NextFunction, Request, Response } from \"express\";\r\nimport Shop from \"../models/Shop\";\r\nimport { HTTP_RESPONSE } from \"../enums/httpErrors.enum\";\r\n\r\n\r\n\r\nconst findShop = async (req:Request, res:Response, next:NextFunction) => {\r\n        try {\r\n        const isShop = await Shop.findOne({ email: req.body.email });\r\n        if (isShop) {\r\n            return res.status(HTTP_RESPONSE.BadRequest).json({ message: \"El comercio ya existe\" });\r\n        }\r\n        next();\r\n        } catch (error) {\r\n        // Manejo del error\r\n        console.error(error);\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({ message: \"Error del servidor\", error });\r\n        }\r\n};\r\n\r\n\r\nexport default findShop;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e99d79be557817add5e39884537644a004d09ac8","contentHash":"7157ac3855bb37ac137d3cb8a2589e14b28c57dfedc488bd0f71d00b4b69a12c"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\findUser.middleware.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\middlewares\\findUser.middleware.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":15},"end":{"line":6,"column":57}},"4":{"start":{"line":7,"column":26},"end":{"line":7,"column":61}},"5":{"start":{"line":8,"column":17},"end":{"line":20,"column":1}},"6":{"start":{"line":9,"column":4},"end":{"line":19,"column":5}},"7":{"start":{"line":10,"column":23},"end":{"line":10,"column":78}},"8":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"9":{"start":{"line":12,"column":12},"end":{"line":12,"column":116}},"10":{"start":{"line":14,"column":8},"end":{"line":14,"column":15}},"11":{"start":{"line":17,"column":8},"end":{"line":17,"column":29}},"12":{"start":{"line":18,"column":8},"end":{"line":18,"column":119}},"13":{"start":{"line":21,"column":0},"end":{"line":21,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":17},"end":{"line":8,"column":18}},"loc":{"start":{"line":8,"column":43},"end":{"line":20,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"type":"if","locations":[{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},{"start":{"line":11,"column":8},"end":{"line":13,"column":9}}],"line":11}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1},"f":{"0":1,"1":0},"b":{"0":[1,1,1],"1":[1,0],"2":[1,1],"3":[0,0]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/findUser.middleware.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/middlewares/findUser.middleware.ts"],"names":[],"mappings":";;;;;AACA,0DAAkC;AAClC,8DAAyD;AAGzD,MAAM,QAAQ,GAAG,KAAK,EAAE,GAAW,EAAE,GAAY,EAAE,IAAiB,EAAE,EAAE;IACpE,IAAI;QACA,MAAM,MAAM,GAAG,MAAM,cAAI,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;QAC7D,IAAI,MAAM,EAAE;YACR,OAAO,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,sBAAsB,EAAE,CAAC,CAAC;SACzF;QACL,IAAI,EAAE,CAAC;KACN;IAAC,OAAO,KAAK,EAAE;QACZ,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACrB,GAAG,CAAC,MAAM,CAAC,+BAAa,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,oBAAoB,EAAG,KAAK,EAAC,CAAC,CAAC;KAChG;AACL,CAAC,CAAC;AAEF,kBAAe,QAAQ,CAAC","sourcesContent":["import { NextFunction, Request, Response } from \"express\";\r\nimport User from \"../models/User\";\r\nimport { HTTP_RESPONSE } from \"../enums/httpErrors.enum\";\r\n\r\n\r\nconst findUser = async (req:Request, res:Response, next:NextFunction) => {\r\n    try {\r\n        const isUser = await User.findOne({ email: req.body.email });\r\n        if (isUser) {\r\n            return res.status(HTTP_RESPONSE.BadRequest).json({ message: \"El usuario ya existe\" });\r\n        }\r\n    next();\r\n    } catch (error) {\r\n        console.error(error);\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({ message: \"Error del servidor\" , error});\r\n    }\r\n};\r\n\r\nexport default findUser;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a9a0239697a66147a5f2611e6ccfb22aa6ac98ad","contentHash":"fe5dd45fc9226d4769b76a91f8e79ced231de5b44f4e77bef742448900658b9d"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\product.routes.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\product.routes.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":18},"end":{"line":6,"column":36}},"4":{"start":{"line":7,"column":37},"end":{"line":7,"column":89}},"5":{"start":{"line":8,"column":29},"end":{"line":8,"column":73}},"6":{"start":{"line":9,"column":25},"end":{"line":9,"column":61}},"7":{"start":{"line":10,"column":30},"end":{"line":10,"column":92}},"8":{"start":{"line":11,"column":37},"end":{"line":11,"column":106}},"9":{"start":{"line":12,"column":20},"end":{"line":12,"column":49}},"10":{"start":{"line":13,"column":24},"end":{"line":13,"column":74}},"11":{"start":{"line":14,"column":16},"end":{"line":14,"column":55}},"12":{"start":{"line":15,"column":15},"end":{"line":15,"column":56}},"13":{"start":{"line":16,"column":15},"end":{"line":16,"column":38}},"14":{"start":{"line":18,"column":0},"end":{"line":18,"column":277}},"15":{"start":{"line":19,"column":0},"end":{"line":19,"column":198}},"16":{"start":{"line":20,"column":0},"end":{"line":20,"column":176}},"17":{"start":{"line":21,"column":0},"end":{"line":21,"column":62}},"18":{"start":{"line":22,"column":0},"end":{"line":22,"column":89}},"19":{"start":{"line":23,"column":0},"end":{"line":23,"column":98}},"20":{"start":{"line":24,"column":0},"end":{"line":24,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":3,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1},"f":{"0":3},"b":{"0":[1,1,1],"1":[3,0],"2":[3,3]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/product.routes.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/product.routes.ts"],"names":[],"mappings":";;;;;AAAA,qCAA+B;AAC/B,0FAA6E;AAC7E,0EAAuJ;AACvJ,8DAAgE;AAChE,6FAAiE;AACjE,2GAAuE;AACvE,kDAA+C;AAC/C,2EAA4C;AAI5C,MAAM,OAAO,GAAG,uBAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;AACvC,MAAM,MAAM,GAAG,IAAA,uBAAM,EAAC,EAAC,OAAO,EAAC,CAAC,CAAA;AAEhC,MAAM,MAAM,GAAI,IAAA,gBAAM,GAAE,CAAC;AACzB,0CAA0C;AAE1C,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,IAAI,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,IAAA,6CAAgB,EAAC,oCAAmB,CAAC,CAAC,EAAG,kCAAa,CAAC,CAAC;AAExJ,MAAM,CAAC,GAAG,CAAC,oBAAoB,EAAE,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,IAAI,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,EAAE,kCAAa,CAAC,CAAC;AAE3H,MAAM,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,IAAI,CAAC,CAAC,EAAG,kCAAa,CAAC,CAAC;AAGtG,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,yCAAoB,CAAC,CAAC;AAEzC,MAAM,CAAC,GAAG,CAAC,SAAS,EAAC,6BAAe,EAAE,kCAAa,CAAC,CAAC;AAErD,MAAM,CAAC,GAAG,CAAC,eAAe,EAAC,6BAAe,EAAE,qCAAgB,CAAC,CAAC;AAI9D,kBAAe,MAAM,CAAC","sourcesContent":["import {Router} from 'express';\r\nimport { schemaValidation } from '../middlewares/schemaValidator.middleware';\r\nimport { createProduct, deleteProduct, getAllProductsByShop, getProductByShop, searchProduct, updateProduct } from '../controllers/product.controller';\r\nimport { createProductSchema } from '../schemas/product.schema';\r\nimport authenticateJWT from '../middlewares/checkJWT.middleware';\r\nimport authorizeRole  from '../middlewares/authorizeByRole.middleware';\r\nimport { RolesEnum } from '../enums/user.enum';\r\nimport multer from '../utils/multer.config';\r\nimport findShop from '../middlewares/findShop.middleware';\r\n\r\n\r\nconst storage = multer.diskStorage({});\r\nconst upload = multer({storage})\r\n\r\nconst router =  Router();\r\n// , schemaValidation(createProductSchema)\r\n\r\nrouter.post('/create', [authenticateJWT, authorizeRole(RolesEnum.SHOP), upload.single(\"image\"), schemaValidation(createProductSchema)] , createProduct);\r\n\r\nrouter.put('/update/:productId', [authenticateJWT, authorizeRole(RolesEnum.SHOP), upload.single(\"image\"),], updateProduct);\r\n\r\nrouter.delete('/delete/:productId', [authenticateJWT, authorizeRole(RolesEnum.SHOP)] , deleteProduct);\r\n\r\n\r\nrouter.get('/all', getAllProductsByShop);\r\n\r\nrouter.get('/search',authenticateJWT, searchProduct);\r\n\r\nrouter.get('/shop/:shopId',authenticateJWT, getProductByShop);\r\n\r\n\r\n\r\nexport default router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ddd0ec75d906b922015b5cdab47495003c3cb9df","contentHash":"eace697eb98c6bcde767b9add2c8cfa115f10b399b454692db521b727bb4eb8d"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\product.schema.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\product.schema.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":28}},"3":{"start":{"line":5,"column":0},"end":{"line":19,"column":3}},"4":{"start":{"line":9,"column":32},"end":{"line":9,"column":49}},"5":{"start":{"line":10,"column":12},"end":{"line":10,"column":58}},"6":{"start":{"line":13,"column":32},"end":{"line":13,"column":49}},"7":{"start":{"line":14,"column":12},"end":{"line":14,"column":59}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":39},"end":{"line":8,"column":40}},"loc":{"start":{"line":8,"column":50},"end":{"line":11,"column":9}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":12,"column":39},"end":{"line":12,"column":40}},"loc":{"start":{"line":12,"column":50},"end":{"line":15,"column":9}},"line":12}},"branchMap":{"0":{"loc":{"start":{"line":10,"column":19},"end":{"line":10,"column":57}},"type":"binary-expr","locations":[{"start":{"line":10,"column":19},"end":{"line":10,"column":38}},{"start":{"line":10,"column":42},"end":{"line":10,"column":57}}],"line":10},"1":{"loc":{"start":{"line":14,"column":19},"end":{"line":14,"column":58}},"type":"binary-expr","locations":[{"start":{"line":14,"column":19},"end":{"line":14,"column":38}},{"start":{"line":14,"column":42},"end":{"line":14,"column":58}}],"line":14}},"s":{"0":1,"1":1,"2":1,"3":1,"4":2,"5":2,"6":2,"7":2},"f":{"0":2,"1":2},"b":{"0":[2,2],"1":[2,2]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/product.schema.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/product.schema.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AAGX,QAAA,mBAAmB,GAAG,OAAC,CAAC,MAAM,CAAC;IACxC,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC;QACX,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,qCAAqC,CAAC;QAEjE,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,EAAE;YAC/B,MAAM,WAAW,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;YACtC,OAAO,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,WAAW,GAAG,CAAC,CAAC;QAClD,CAAC,EAAE,EAAC,OAAO,EAAE,8CAA8C,GAAE,CAAC;QAE9D,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,EAAE;YAC/B,MAAM,WAAW,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;YACtC,OAAO,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,WAAW,IAAI,CAAC,CAAC;QACnD,CAAC,EAAE,EAAC,OAAO,EAAE,6CAA6C,GAAE,CAAC;QAE7D,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC,EAAC,cAAc,EAAC,mCAAmC,EAAE,kBAAkB,EAAC,0BAA0B,EAAC,CAAC,CAAC,QAAQ,CAAC,mCAAmC,CAAC;QAEjK,QAAQ,EAAE,OAAC,CAAC,MAAM,CAAC,EAAC,cAAc,EAAC,sCAAsC,EAAE,kBAAkB,EAAC,0BAA0B,EAAC,CAAC,CAAC,QAAQ,CAAC,sCAAsC,CAAC;KAC9K,CAAC;CACL,CAAC,CAAC","sourcesContent":["import { z } from \"zod\";\r\n\r\n\r\nexport const createProductSchema = z.object({\r\n    body: z.object({\r\n        title: z.string().nonempty(\"El nombre del producto es requerido\"),\r\n    \r\n        price: z.string().refine((value) => {\r\n            const numberValue = parseFloat(value);\r\n            return !isNaN(numberValue) && numberValue > 0;\r\n        }, {message: \"El precio debe ser un número positivo válido\",}),\r\n\r\n        stock: z.string().refine((value) => {\r\n            const numberValue = parseFloat(value);\r\n            return !isNaN(numberValue) && numberValue >= 0;\r\n        }, {message: \"El stock debe ser un número positivo válido\",}),\r\n\r\n        shop: z.string({required_error:\"EL id de la tienda es obligatorio\", invalid_type_error:\"El id debe ser un string\"}).nonempty(\"EL id de la tienda es obligatorio\"),\r\n        \r\n        category: z.string({required_error:\"EL id de la categoría es obligatorio\", invalid_type_error:\"El id debe ser un string\"}).nonempty(\"EL id de la categoría es obligatorio\")\r\n    })\r\n});\r\n\r\n\r\n\r\n\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7929c3a8e7d4c8ab4ad9e918e81877e4d7f00f2a","contentHash":"51757eca4a787ae096a8988d696982682e468c1f45bbddecf545e169790a6e99"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\utils\\multer.config.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\utils\\multer.config.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":17},"end":{"line":6,"column":51}},"4":{"start":{"line":7,"column":15},"end":{"line":7,"column":47}},"5":{"start":{"line":8,"column":0},"end":{"line":18,"column":3}},"6":{"start":{"line":11,"column":18},"end":{"line":11,"column":59}},"7":{"start":{"line":12,"column":8},"end":{"line":15,"column":9}},"8":{"start":{"line":13,"column":12},"end":{"line":13,"column":28}},"9":{"start":{"line":14,"column":12},"end":{"line":14,"column":19}},"10":{"start":{"line":16,"column":8},"end":{"line":16,"column":23}},"11":{"start":{"line":19,"column":0},"end":{"line":19,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":16},"end":{"line":10,"column":17}},"loc":{"start":{"line":10,"column":35},"end":{"line":17,"column":5}},"line":10}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":12,"column":8},"end":{"line":15,"column":9}},"type":"if","locations":[{"start":{"line":12,"column":8},"end":{"line":15,"column":9}},{"start":{"line":12,"column":8},"end":{"line":15,"column":9}}],"line":12},"4":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":63}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":26}},{"start":{"line":12,"column":30},"end":{"line":12,"column":45}},{"start":{"line":12,"column":49},"end":{"line":12,"column":63}}],"line":12}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"f":{"0":2,"1":0},"b":{"0":[1,1,1],"1":[0,2],"2":[2,2],"3":[0,0],"4":[0,0,0]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/utils/multer.config.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/utils/multer.config.ts"],"names":[],"mappings":";;;;;AAAA,oDAA4B;AAC5B,gDAA0B;AAI1B,IAAA,gBAAM,EAAC;IACH,OAAO,EAAE,gBAAM,CAAC,WAAW,CAAC,EAAE,CAAC;IAC/B,UAAU,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE;QAC1B,IAAI,GAAG,GAAG,cAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAC1C,IAAG,GAAG,KAAK,MAAM,IAAI,GAAG,KAAK,OAAO,IAAI,GAAG,KAAK,MAAM,EAAC;YACnD,EAAE,CAAE,IAAI,EAAE,KAAK,CAAC,CAAC;YACjB,OAAO;SACV;QACD,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IACnB,CAAC;CACJ,CAAC,CAAA;AAEF,kBAAe,gBAAM,CAAC","sourcesContent":["import multer from 'multer';\r\nimport  path  from 'path';\r\n\r\n\r\n\r\nmulter({\r\n    storage: multer.diskStorage({}),\r\n    fileFilter: (req, file, cb) =>{\r\n        let ext = path.extname(file.originalname);\r\n        if(ext !== \".jpg\" && ext !== \".jpeg\" && ext !== \".png\"){\r\n            cb( null, false);\r\n            return;\r\n        }\r\n        cb(null, true);\r\n    }\r\n})\r\n\r\nexport default multer;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fc3911db823afe8a8df593384d7a9b9db91323ef","contentHash":"3f75efe449b43c9d49cbea3e1f6b654bae1aac312d140d64e3e2cc15ad401766"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\category.routes.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\routes\\category.routes.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":18},"end":{"line":6,"column":36}},"4":{"start":{"line":7,"column":30},"end":{"line":7,"column":75}},"5":{"start":{"line":8,"column":30},"end":{"line":8,"column":92}},"6":{"start":{"line":9,"column":37},"end":{"line":9,"column":106}},"7":{"start":{"line":10,"column":20},"end":{"line":10,"column":49}},"8":{"start":{"line":11,"column":37},"end":{"line":11,"column":89}},"9":{"start":{"line":12,"column":26},"end":{"line":12,"column":63}},"10":{"start":{"line":13,"column":15},"end":{"line":13,"column":38}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":252}},"12":{"start":{"line":15,"column":0},"end":{"line":15,"column":172}},"13":{"start":{"line":16,"column":0},"end":{"line":16,"column":255}},"14":{"start":{"line":17,"column":0},"end":{"line":17,"column":56}},"15":{"start":{"line":18,"column":0},"end":{"line":18,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1},"f":{"0":2},"b":{"0":[1,1,1],"1":[2,0],"2":[2,2]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/category.routes.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/routes/category.routes.ts"],"names":[],"mappings":";;;;;AAAA,qCAA8B;AAC9B,4EAAsH;AACtH,6FAAiE;AACjE,2GAAsE;AACtE,kDAA+C;AAC/C,0FAA6E;AAC7E,gEAA4D;AAI5D,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAExB,MAAM,CAAC,IAAI,CAAC,SAAS,EAAC,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,KAAK,CAAC,EAAE,IAAA,6CAAgB,EAAC,gCAAc,CAAC,CAAC,EAAG,oCAAc,CAAC,CAAC;AAC5H,MAAM,CAAC,MAAM,CAAC,aAAa,EAAC,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,KAAK,CAAC,CAAC,EAAE,oCAAc,CAAC,CAAC;AAC/F,MAAM,CAAC,GAAG,CAAC,aAAa,EAAC,CAAC,6BAAe,EAAE,IAAA,oCAAa,EAAC,qBAAS,CAAC,KAAK,CAAC,EAAE,IAAA,6CAAgB,EAAC,gCAAc,CAAC,CAAC,EAAE,oCAAc,CAAC,CAAC;AAC9H,MAAM,CAAC,GAAG,CAAC,GAAG,EAAC,sCAAgB,CAAC,CAAC;AAEjC,kBAAe,MAAM,CAAC;AAGtB;;;;;;;;;;;;;;;;;;GAkBG;AAGH;;;;;;;;;;;;;;;;;GAiBG;AAEH;;;;;;;;;;GAUG;AAGH;;;;;;;;;;;;;;;;;;;;;;;;GAwBG;AAGH;;;;;;;;;;;;;;;;;GAiBG","sourcesContent":["import {Router} from 'express'\r\nimport { createCategory, deleteCategory, getAllCategories, updateCategory } from '../controllers/category.controller';\r\nimport authenticateJWT from '../middlewares/checkJWT.middleware';\r\nimport authorizeRole from '../middlewares/authorizeByRole.middleware';\r\nimport { RolesEnum } from '../enums/user.enum';\r\nimport { schemaValidation } from '../middlewares/schemaValidator.middleware';\r\nimport { categorySchema } from '../schemas/category.schema';\r\n\r\n\r\n\r\nconst router = Router();\r\n\r\nrouter.post('/create',[authenticateJWT, authorizeRole(RolesEnum.ADMIN), schemaValidation(categorySchema)]  ,createCategory);\r\nrouter.delete('/delete/:id',[authenticateJWT, authorizeRole(RolesEnum.ADMIN)], deleteCategory);\r\nrouter.put('/update/:id',[authenticateJWT, authorizeRole(RolesEnum.ADMIN), schemaValidation(categorySchema)], updateCategory);\r\nrouter.get('/',getAllCategories);\r\n\r\nexport default router;\r\n\r\n\r\n/**\r\n * @swagger\r\n * components:\r\n *  schemas:\r\n *    Category:\r\n *      type: object\r\n *      properties:\r\n *          _id:\r\n *            type: string\r\n *            description: Id category\r\n *          categoryName:\r\n *            type: string\r\n *            description: Category name\r\n *      required:\r\n *        - categoryName\r\n *      example:\r\n *        categoryName: \"testCategory\"\r\n *             \r\n */\r\n\r\n\r\n/**\r\n * @swagger\r\n *   /category/create:\r\n *   post:\r\n *     tags: [Category]\r\n *     summary: Create a category\r\n *     description: Create a category\r\n *     requestBody:\r\n *          required: true\r\n *          content:\r\n *            application/json:\r\n *              schema:\r\n *               type: object\r\n *               $ref: '#components/schemas/Category'\r\n *     responses:\r\n *       201:\r\n *         description: return the new category.\r\n */\r\n\r\n/**\r\n * @swagger\r\n *   /category/:\r\n *   get:\r\n *     tags: [Category]\r\n *     summary: Get all categories\r\n *     description: Get all categories\r\n *     responses:\r\n *       200:\r\n *         description: return the all categories.\r\n */\r\n\r\n\r\n/**\r\n * @swagger\r\n *   /category/update/{id}:\r\n *   put:\r\n *     tags: [Category]\r\n *     summary: update a category by id\r\n *     description: update a category by id\r\n *     parameters:\r\n *       - in: path\r\n *         name: id\r\n *         description: Category ID\r\n *         required: true\r\n *         schema:\r\n *           type: string\r\n *     requestBody:\r\n *          required: true\r\n *          content:\r\n *            application/json:\r\n *              schema:\r\n *               type: object\r\n *               $ref: '#components/schemas/Category'\r\n *     responses:\r\n *       200:\r\n *         description: return the all categories.\r\n */\r\n\r\n\r\n/**\r\n * @swagger\r\n *   /category/delete{id}:\r\n *   delete:\r\n *     tags: [Category]\r\n *     summary: Delete a category by id\r\n *     description: Delete a category by id\r\n *     parameters:\r\n *       - in: path\r\n *         name: id\r\n *         description: Category ID\r\n *         required: true\r\n *         schema:\r\n *           type: string\r\n *     responses:\r\n *       200:\r\n *         description: return the all categories.\r\n */"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"92afe97d4f20278ec6be4e5dfbe6aa981c6428b1","contentHash":"b0adecb12bf73d7af77948b73d28e7d81af7e0e821aaef0d254d717c3f436e61"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\category.controller.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\controllers\\category.controller.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":109}},"4":{"start":{"line":7,"column":19},"end":{"line":7,"column":65}},"5":{"start":{"line":8,"column":26},"end":{"line":8,"column":61}},"6":{"start":{"line":9,"column":19},"end":{"line":9,"column":38}},"7":{"start":{"line":10,"column":23},"end":{"line":27,"column":1}},"8":{"start":{"line":11,"column":4},"end":{"line":26,"column":5}},"9":{"start":{"line":12,"column":33},"end":{"line":12,"column":41}},"10":{"start":{"line":13,"column":8},"end":{"line":14,"column":97}},"11":{"start":{"line":14,"column":12},"end":{"line":14,"column":97}},"12":{"start":{"line":15,"column":34},"end":{"line":15,"column":67}},"13":{"start":{"line":16,"column":27},"end":{"line":16,"column":98}},"14":{"start":{"line":17,"column":8},"end":{"line":18,"column":79}},"15":{"start":{"line":18,"column":12},"end":{"line":18,"column":79}},"16":{"start":{"line":19,"column":25},"end":{"line":19,"column":93}},"17":{"start":{"line":20,"column":8},"end":{"line":20,"column":30}},"18":{"start":{"line":21,"column":8},"end":{"line":21,"column":75}},"19":{"start":{"line":24,"column":8},"end":{"line":24,"column":27}},"20":{"start":{"line":25,"column":8},"end":{"line":25,"column":115}},"21":{"start":{"line":28,"column":0},"end":{"line":28,"column":40}},"22":{"start":{"line":29,"column":25},"end":{"line":38,"column":1}},"23":{"start":{"line":30,"column":4},"end":{"line":37,"column":5}},"24":{"start":{"line":31,"column":27},"end":{"line":31,"column":60}},"25":{"start":{"line":32,"column":8},"end":{"line":32,"column":29}},"26":{"start":{"line":35,"column":8},"end":{"line":35,"column":27}},"27":{"start":{"line":36,"column":8},"end":{"line":36,"column":115}},"28":{"start":{"line":39,"column":0},"end":{"line":39,"column":44}},"29":{"start":{"line":40,"column":23},"end":{"line":53,"column":1}},"30":{"start":{"line":41,"column":4},"end":{"line":52,"column":5}},"31":{"start":{"line":42,"column":20},"end":{"line":42,"column":33}},"32":{"start":{"line":43,"column":27},"end":{"line":43,"column":65}},"33":{"start":{"line":44,"column":8},"end":{"line":45,"column":116}},"34":{"start":{"line":45,"column":12},"end":{"line":45,"column":116}},"35":{"start":{"line":46,"column":8},"end":{"line":46,"column":37}},"36":{"start":{"line":47,"column":8},"end":{"line":47,"column":105}},"37":{"start":{"line":50,"column":8},"end":{"line":50,"column":27}},"38":{"start":{"line":51,"column":8},"end":{"line":51,"column":115}},"39":{"start":{"line":54,"column":0},"end":{"line":54,"column":40}},"40":{"start":{"line":55,"column":23},"end":{"line":70,"column":1}},"41":{"start":{"line":56,"column":4},"end":{"line":69,"column":5}},"42":{"start":{"line":57,"column":20},"end":{"line":57,"column":33}},"43":{"start":{"line":58,"column":8},"end":{"line":59,"column":86}},"44":{"start":{"line":59,"column":12},"end":{"line":59,"column":86}},"45":{"start":{"line":60,"column":27},"end":{"line":60,"column":65}},"46":{"start":{"line":61,"column":8},"end":{"line":62,"column":116}},"47":{"start":{"line":62,"column":12},"end":{"line":62,"column":116}},"48":{"start":{"line":63,"column":28},"end":{"line":63,"column":107}},"49":{"start":{"line":64,"column":8},"end":{"line":64,"column":73}},"50":{"start":{"line":67,"column":8},"end":{"line":67,"column":27}},"51":{"start":{"line":68,"column":8},"end":{"line":68,"column":115}},"52":{"start":{"line":71,"column":0},"end":{"line":71,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":23},"end":{"line":10,"column":24}},"loc":{"start":{"line":10,"column":43},"end":{"line":27,"column":1}},"line":10},"2":{"name":"(anonymous_2)","decl":{"start":{"line":29,"column":25},"end":{"line":29,"column":26}},"loc":{"start":{"line":29,"column":45},"end":{"line":38,"column":1}},"line":29},"3":{"name":"(anonymous_3)","decl":{"start":{"line":40,"column":23},"end":{"line":40,"column":24}},"loc":{"start":{"line":40,"column":43},"end":{"line":53,"column":1}},"line":40},"4":{"name":"(anonymous_4)","decl":{"start":{"line":55,"column":23},"end":{"line":55,"column":24}},"loc":{"start":{"line":55,"column":43},"end":{"line":70,"column":1}},"line":55}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":13,"column":8},"end":{"line":14,"column":97}},"type":"if","locations":[{"start":{"line":13,"column":8},"end":{"line":14,"column":97}},{"start":{"line":13,"column":8},"end":{"line":14,"column":97}}],"line":13},"4":{"loc":{"start":{"line":17,"column":8},"end":{"line":18,"column":79}},"type":"if","locations":[{"start":{"line":17,"column":8},"end":{"line":18,"column":79}},{"start":{"line":17,"column":8},"end":{"line":18,"column":79}}],"line":17},"5":{"loc":{"start":{"line":44,"column":8},"end":{"line":45,"column":116}},"type":"if","locations":[{"start":{"line":44,"column":8},"end":{"line":45,"column":116}},{"start":{"line":44,"column":8},"end":{"line":45,"column":116}}],"line":44},"6":{"loc":{"start":{"line":58,"column":8},"end":{"line":59,"column":86}},"type":"if","locations":[{"start":{"line":58,"column":8},"end":{"line":59,"column":86}},{"start":{"line":58,"column":8},"end":{"line":59,"column":86}}],"line":58},"7":{"loc":{"start":{"line":61,"column":8},"end":{"line":62,"column":116}},"type":"if","locations":[{"start":{"line":61,"column":8},"end":{"line":62,"column":116}},{"start":{"line":61,"column":8},"end":{"line":62,"column":116}}],"line":61}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":2,"10":2,"11":0,"12":2,"13":2,"14":2,"15":1,"16":1,"17":1,"18":1,"19":0,"20":0,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":2,"31":2,"32":2,"33":2,"34":1,"35":1,"36":1,"37":0,"38":0,"39":1,"40":1,"41":1,"42":1,"43":1,"44":0,"45":1,"46":1,"47":0,"48":1,"49":1,"50":0,"51":0,"52":1},"f":{"0":1,"1":2,"2":1,"3":2,"4":1},"b":{"0":[1,1,1],"1":[1,0],"2":[1,1],"3":[0,2],"4":[1,1],"5":[1,1],"6":[0,1],"7":[0,1]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/category.controller.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/controllers/category.controller.ts"],"names":[],"mappings":"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","sourcesContent":["import {Request, Response} from 'express'\r\nimport Category, { CategoryI } from \"../models/Category\";\r\nimport { HTTP_RESPONSE } from '../enums/httpErrors.enum';\r\nimport { isObjectIdOrHexString } from 'mongoose';\r\n\r\n\r\nexport const createCategory = async(req: Request, res: Response) => {\r\n    try {\r\n        const {categoryName}:CategoryI = req.body;\r\n\r\n        if(!categoryName) return res.status(404).json({message:\"No se proporciono un nombre de categoría\"});\r\n\r\n        const lowerCategoryName = categoryName.toLowerCase().trim();\r\n\r\n\r\n\r\n        const isCategory = await Category.findOne({'categoryName': lowerCategoryName});\r\n        if(isCategory) return res.status(400).json({message:\"La categoría ya existe\"});\r\n\r\n        const category = await Category.create({categoryName: lowerCategoryName});\r\n        await category.save();\r\n\r\n        res.status(HTTP_RESPONSE.Created).json(category);\r\n\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message:\"Internal server error\"})\r\n    }\r\n}\r\n\r\nexport const getAllCategories = async( req:Request, res:Response) => {\r\n    try {\r\n        const categories = await Category.find({});\r\n\r\n        res.json(categories);\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message:\"Internal server error\"})\r\n    }\r\n}\r\n\r\n\r\nexport const deleteCategory = async(req:Request, res: Response) => {\r\n    try {\r\n        const _id = req.params.id;\r\n        const isCategory = await Category.findById(_id);\r\n        if(!isCategory) return res.status(HTTP_RESPONSE.NotFound).json({message:\"La categoría no existe\"}); \r\n\r\n        await isCategory.deleteOne();\r\n        res.status(HTTP_RESPONSE.Created).json({message: 'Eliminada correctamente'})\r\n\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message:\"Internal server error\"})\r\n    }\r\n}\r\n\r\nexport const updateCategory = async(req: Request, res:Response) => {\r\n    try {\r\n        const _id = req.params.id;\r\n\r\n        if(!isObjectIdOrHexString(_id)) return res.status(400).json({message:`id: ${_id} formato incorrecto`});\r\n        const isCategory = await Category.findById(_id);\r\n\r\n        if(!isCategory) return res.status(HTTP_RESPONSE.NotFound).json({message:\"La categoría no existe\"});\r\n        \r\n        const newCategory = await Category.findByIdAndUpdate(_id,{...req.body}, {new: true});\r\n        res.status(HTTP_RESPONSE.OK).json(newCategory)\r\n    } catch (error) {\r\n        console.log(error)\r\n        res.status(HTTP_RESPONSE.InternalServerError).json({message:\"Internal server error\"})\r\n    }\r\n}\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2f958dfc0d212309037d55df75ce8a9895fbadd2","contentHash":"293f311351adf6dd3a117ed147cec99a89f0940407e77d99b63733004efba62f"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\category.schema.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\schemas\\category.schema.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":28}},"3":{"start":{"line":5,"column":0},"end":{"line":9,"column":3}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/category.schema.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/schemas/category.schema.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AAGX,QAAA,cAAc,GAAG,OAAC,CAAC,MAAM,CAAC;IACnC,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC;QACX,YAAY,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,mDAAmD,CAAC,CAAC,QAAQ,CAAC,2BAA2B,CAAC;KAC7H,CAAC;CACL,CAAC,CAAA","sourcesContent":["import { z } from \"zod\";\r\n\r\n\r\nexport const categorySchema = z.object({\r\n    body: z.object({\r\n        categoryName: z.string().min(3, \"La categoría debe tener un mínimo de 3 caracteres\").nonempty(\"La categoría es requerida\"),\r\n    })\r\n})\r\n\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4a40be3479d28aededc33b9b68804ae107c59a03","contentHash":"5669bcdb3e2b9447ac107ee1b634ef40175e80289faddeed72620c235f00efc5"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\database\\config.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\database\\config.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":19},"end":{"line":6,"column":55}},"4":{"start":{"line":7,"column":21},"end":{"line":18,"column":1}},"5":{"start":{"line":8,"column":4},"end":{"line":17,"column":5}},"6":{"start":{"line":9,"column":23},"end":{"line":9,"column":47}},"7":{"start":{"line":10,"column":8},"end":{"line":11,"column":66}},"8":{"start":{"line":11,"column":12},"end":{"line":11,"column":66}},"9":{"start":{"line":12,"column":8},"end":{"line":12,"column":49}},"10":{"start":{"line":13,"column":8},"end":{"line":13,"column":50}},"11":{"start":{"line":16,"column":8},"end":{"line":16,"column":60}},"12":{"start":{"line":19,"column":0},"end":{"line":19,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":21},"end":{"line":7,"column":22}},"loc":{"start":{"line":7,"column":33},"end":{"line":18,"column":1}},"line":7}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":9,"column":23},"end":{"line":9,"column":47}},"type":"binary-expr","locations":[{"start":{"line":9,"column":23},"end":{"line":9,"column":41}},{"start":{"line":9,"column":45},"end":{"line":9,"column":47}}],"line":9},"4":{"loc":{"start":{"line":10,"column":8},"end":{"line":11,"column":66}},"type":"if","locations":[{"start":{"line":10,"column":8},"end":{"line":11,"column":66}},{"start":{"line":10,"column":8},"end":{"line":11,"column":66}}],"line":10}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":1,"11":0,"12":1},"f":{"0":1,"1":1},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[1,0],"4":[0,1]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/database/config.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/database/config.ts"],"names":[],"mappings":";;;;;AAAA,wDAA+B;AAG/B,MAAM,YAAY,GAAG,KAAK,IAAG,EAAE;IAC3B,IAAI;QACA,MAAM,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,IAAI,EAAE,CAAC;QACxC,IAAG,CAAC,MAAM;YAAE,OAAO,8CAA8C,CAAC;QAGlE,MAAM,kBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAE/B,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;KAC7C;IAAC,OAAO,KAAK,EAAE;QACZ,OAAO,CAAC,KAAK,CAAC,6BAA6B,EAAE,KAAK,CAAC,CAAC;KACvD;AACL,CAAC,CAAA;AAED,kBAAe,YAAY,CAAC","sourcesContent":["import mongoose from \"mongoose\"\r\n\r\n\r\nconst dbConnection = async() => {\r\n    try {\r\n        const DB_URI = process.env.DB_URI || \"\";\r\n        if(!DB_URI) return \"No hay variable de entorno de conexion mongo\";\r\n\r\n\r\n        await mongoose.connect(DB_URI);\r\n\r\n        console.log('Conexión exitosa a MongoDB');\r\n    } catch (error) {\r\n        console.error('Error al conectar a MongoDB', error);\r\n    }\r\n}\r\n\r\nexport default dbConnection;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2e7fa878be7f7ceff7249879fd34d540facaa859","contentHash":"6cdb4db578ec783dc045e02e946efa1f3cba728d1f491aaf459b1a98c0f1502c"},"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\swagger.ts":{"path":"C:\\Users\\marce\\OneDrive\\Escritorio\\ACL\\MYMARKET\\MERN-BACKEND\\src\\swagger.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":24},"end":{"line":6,"column":65}},"4":{"start":{"line":7,"column":29},"end":{"line":7,"column":75}},"5":{"start":{"line":8,"column":16},"end":{"line":23,"column":1}},"6":{"start":{"line":24,"column":14},"end":{"line":24,"column":51}},"7":{"start":{"line":26,"column":4},"end":{"line":26,"column":104}},"8":{"start":{"line":28,"column":0},"end":{"line":28,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"setupSwagger","decl":{"start":{"line":25,"column":9},"end":{"line":25,"column":21}},"loc":{"start":{"line":25,"column":27},"end":{"line":27,"column":1}},"line":25}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1},"f":{"0":2,"1":1},"b":{"0":[1,1,1],"1":[0,2],"2":[2,2]},"inputSourceMap":{"version":3,"file":"C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/swagger.ts","sources":["C:/Users/marce/OneDrive/Escritorio/ACL/MYMARKET/MERN-BACKEND/src/swagger.ts"],"names":[],"mappings":";;;;;AAAA,kEAAyC;AACzC,4EAA+D;AAI/D,MAAM,OAAO,GAAkB;IAC3B,UAAU,EAAE;QACR,OAAO,EAAE,OAAO;QACZ,IAAI,EAAE;YACF,KAAK,EAAE,4BAA4B;YACnC,OAAO,EAAE,OAAO;YAChB,WAAW,EAAE,oCAAoC;SACpD;QACD,OAAO,EAAC;YACJ;gBACI,GAAG,EAAE,2BAA2B;aACnC;SACJ;KACR;IACH,IAAI,EAAE,CAAC,SAAS,CAAC,EAAE,8DAA8D;CAClF,CAAC;AAEF,MAAM,KAAK,GAAG,IAAA,uBAAY,EAAC,OAAO,CAAC,CAAC;AAEpC,SAAwB,YAAY,CAAC,GAAW;IAC5C,GAAG,CAAC,GAAG,CAAC,WAAW,EAAE,4BAAS,CAAC,KAAK,EAAE,4BAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;AAClE,CAAC;AAFD,+BAEC","sourcesContent":["import swaggerJsdoc from 'swagger-jsdoc';\r\nimport swaggerUi, { SwaggerOptions } from 'swagger-ui-express';\r\nimport {Express} from 'express';\r\n\r\n\r\nconst options:SwaggerOptions = {\r\n    definition: {\r\n        openapi: '3.0.0',\r\n            info: {\r\n                title: 'MyMarket API Documentation',\r\n                version: '1.0.0',\r\n                description: 'API Documentation for MyMarket API',\r\n            },\r\n            servers:[\r\n                {\r\n                    url: \"http://localhost:4000/api\"\r\n                }\r\n            ]\r\n    },\r\n  apis: ['**/*.ts'], // Especifica la ubicación de tus archivos de rutas de Express\r\n};\r\n\r\nconst specs = swaggerJsdoc(options);\r\n\r\nexport default function setupSwagger(app:Express) {\r\n    app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(specs));\r\n}\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f7f51a6aefe55f29281ecd2c906978afdc753a8d","contentHash":"b1d8f7f0457e7035fe2cea01b7cf446adc14e794048171eec2b09755b37d006e"}}